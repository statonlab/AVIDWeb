(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"8ORw":function(e,t,a){var n=a("muzd");"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,s);n.locals&&(e.exports=n.locals)},"Hp/o":function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"\n.height-auto[data-v-23dc7042] {\n    height: auto !important;\n}\n",""])},N0V6:function(e,t,a){"use strict";var n=a("NlcB");a.n(n).a},NlcB:function(e,t,a){var n=a("Hp/o");"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,s);n.locals&&(e.exports=n.locals)},Y3if:function(e,t,a){"use strict";var n=a("o0o1"),s=a.n(n),r=a("yJCx"),o=a("TTxJ"),i=a("uHij"),c=a("cv7c"),l=a("+Gql"),u=a("wd/R"),d=a.n(u);function p(e,t,a,n,s,r,o){try{var i=e[r](o),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,s)}function f(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){p(r,n,s,o,i,"next",e)}function i(e){p(r,n,s,o,i,"throw",e)}o(void 0)}))}}var m={name:"SitesDataView",components:{Pager:r.a,InlineSpinner:o.a,SiteForm:i.a,Icon:c.a},props:{url:{required:!1,type:String,default:"/web/sites"},showSiteType:{required:!1,type:Boolean,default:!1},editable:{required:!1,type:Boolean,default:!1},showOwner:{required:!1,type:Boolean,default:!1},siteUrlPrefix:{required:!1,type:String,default:"/app/sites"},unauthorizedMessage:{required:!1,type:String,default:"You do not have permission to view sites."}},data:function(){return{moment:d.a,User:l.a,showSiteForm:!1,siteType:this.showSiteType?"all":null,sites:[],invitations:[],loading:!1,page:1,lastPage:1,total:0,site:null,deleting:null,search:"",_request:null,orderBy:"last_measured_at",orderDir:"desc",unauthorized:!1}},mounted:function(){this.loading=!0,this.loadSites(),this.loadInvitations()},watch:{search:function(){this.page=1,this.loadSites()},siteType:function(){this.page=1,this.loadSites()}},methods:{loadSites:function(){var e=this;return f(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._request&&e._request(),t.prev=1,t.next=4,axios.get(e.url,{params:{search:e.search,page:e.page,order_by:e.orderBy,order_dir:e.orderDir,site_type:e.siteType},cancelToken:new axios.CancelToken((function(t){return e._request=t}))});case 4:a=t.sent,n=a.data,e.total=n.total,e.sites=n.data,e.lastPage=n.last_page,e.loading=!1,e.$emit("load",n),t.next=21;break;case 13:if(t.prev=13,t.t0=t.catch(1),axios.isCancel(t.t0)){t.next=21;break}if(e.loading=!1,!t.t0.response||403!==t.t0.response.status){t.next=20;break}return e.unauthorized=!0,t.abrupt("return");case 20:console.error(t.t0);case 21:case"end":return t.stop()}}),t,null,[[1,13]])})))()},loadInvitations:function(){var e=this;return f(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("/web/site-invitations");case 3:a=t.sent,n=a.data,e.invitations=n.filter((function(e){return!e.expired})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:e.loading=!1;case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},siteCreated:function(){this.loadSites(),this.closeForm()},siteUpdated:function(e){this.sites=this.sites.map((function(t){return t.id===e.id?e:t})),this.closeForm()},closeForm:function(){this.site=null,this.showSiteForm=!1},edit:function(e){this.site=e,this.showSiteForm=!0},destroy:function(e){var t,a=this;this.$confirm({title:"Are you sure you want to delete ".concat(e.name,"?"),text:"This action is permanent!",onConfirm:(t=f(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.deleting=e.id,t.prev=1,t.next=4,axios.delete("/web/sites/".concat(e.id));case 4:return t.next=6,a.loadSites();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),a.$notify({text:"Unable to delete site. Please try refreshing the page.",type:"error"});case 11:a.deleting=null;case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return t.apply(this,arguments)})})},goTo:function(e){this.page=e,this.loadSites()},sort:function(e){e===this.orderBy?this.orderDir="asc"===this.orderDir?"desc":"asc":(this.orderBy=e,this.orderDir="asc"),this.loadSites()},sortIcon:function(e){return e!==this.orderBy?"swap-vertical":"asc"===this.orderDir?"arrow-up":"arrow-down"},acceptInvitation:function(e){var t=this;return f(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,axios.get("/web/site-invitations/".concat(e.id,"/accept"));case 3:t.$notify({text:"Invitation accepted successfully",type:"success"}),t.invitations=t.invitations.filter((function(t){return t.id!==e.id})),t.loadSites(),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),a.t0.response&&422===a.t0.response.status&&a.t0.response.data.errors.invitation?t.$notify({text:a.t0.response.data.errors.invitation[0],type:"error"}):t.$notify({text:"Unable to accept invitation. Please try refreshing the page.",type:"error"});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()},rejectInvitation:function(e){var t=this;return f(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,axios.get("/web/site-invitations/".concat(e.id,"/reject"));case 3:t.$notify({text:"Invitation rejected successfully",type:"success"}),t.invitations=t.invitations.filter((function(t){return t.id!==e.id})),t.loadSites(),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),a.t0.response&&422===a.t0.response.status&&a.t0.response.data.errors.invitation?t.$notify({text:a.t0.response.data.errors.invitation[0],type:"error"}):t.$notify({text:"Unable to reject invitation. Please try refreshing the page.",type:"error"});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()}}},v=a("KHd+"),h=Object(v.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[0!==e.invitations.length?a("div",{staticClass:"card mb-3"},[a("div",{staticClass:"card-header"},[a("p",{staticClass:"page-title mb-0"},[e._v("Pending Invitations")]),e._v(" "),a("p",{staticClass:"text-muted"},[e._v("You have been invited to view the following sites")]),e._v(" "),a("table",{staticClass:"table mb-0 table-middle table-hover table-nowrap"},[e._m(0),e._v(" "),a("tbody",e._l(e.invitations,(function(t){return a("tr",[a("td",[e._v(e._s(t.site.name))]),e._v(" "),a("td",[e._v(e._s(t.user.name))]),e._v(" "),a("td",{staticClass:"text-right no-wrap"},[a("button",{staticClass:"btn btn-sm btn-outline-primary",on:{click:function(a){return a.preventDefault(),e.acceptInvitation(t)}}},[e._v("\n                            Accept\n                        ")]),e._v(" "),a("button",{staticClass:"btn btn-sm btn-outline-danger",on:{click:function(a){return a.preventDefault(),e.rejectInvitation(t)}}},[e._v("\n                            Reject\n                        ")])])])})),0)])])]):e._e(),e._v(" "),a("div",{staticClass:"card mb-3"},[a("div",{staticClass:"card-header d-flex p-2"},[a("div",{staticClass:"flex-grow-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Search..."},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"pl-1 d-flex align-items-center"},[a("div",{staticClass:"flex-shrink-0"},[e.showSiteType?a("select",{directives:[{name:"model",rawName:"v-model",value:e.siteType,expression:"siteType"}],staticClass:"custom-select",attrs:{name:"site_type",id:"site-type"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.siteType=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"all"}},[e._v("All sites")]),e._v(" "),a("option",{attrs:{value:"shared"}},[e._v("Owned by others")]),e._v(" "),a("option",{attrs:{value:"owned"}},[e._v("Owned by me")])]):e._e()]),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[a("button",{staticClass:"ml-2 btn btn-primary",on:{click:function(t){t.preventDefault(),e.showSiteForm=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("New Site")])],1)])])]),e._v(" "),a("div",{staticClass:"card-body p-0 table-responsive"},[e.loading?a("p",{staticClass:"mb-0 p-4"},[a("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),e.unauthorized?a("p",{staticClass:"mb-0 p-4 text-muted"},[e._v("\n                "+e._s(e.unauthorizedMessage)+"\n            ")]):e._e(),e._v(" "),e.loading||0!==e.sites.length||e.unauthorized?e._e():a("p",{staticClass:"mb-0 p-4 text-muted"},[e._v('\n                No results found. Use the "New Site" button above to create a new one.\n            ')]),e._v(" "),!e.loading&&e.sites.length>0&&!e.unauthorized?a("table",{staticClass:"table mb-0 table-middle table-hover table-nowrap"},[a("thead",[a("tr",[a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("name")}}},[a("span",{staticClass:"mr-1"},[e._v("Name")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("name")}})],1)]),e._v(" "),e.showOwner?a("th",[e._v("\n                        Created By\n                    ")]):e._e(),e._v(" "),a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("plots_count")}}},[a("span",{staticClass:"mr-1"},[e._v("Plots")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("plots_count")}})],1)]),e._v(" "),a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("plants_count")}}},[a("span",{staticClass:"mr-1"},[e._v("Plants")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("plants_count")}})],1)]),e._v(" "),a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("last_measured_at")}}},[a("span",{staticClass:"mr-1"},[e._v("Last Measured")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("last_measured_at")}})],1)]),e._v(" "),a("th")])]),e._v(" "),a("tbody",e._l(e.sites,(function(t){return a("tr",{class:{"on-hover":e.deleting!==t.id}},[a("td",[a("router-link",{attrs:{to:e.siteUrlPrefix+"/"+t.id}},[a("strong",[e._v(e._s(t.name))])]),e._v(" "),a("div",{staticClass:"text-muted"},[e._v("\n                            "+e._s(t.county.name)+", "+e._s(t.state.code)+"\n                        ")])],1),e._v(" "),e.showOwner?a("td",[e._v(e._s(t.user.name))]):e._e(),e._v(" "),a("td",[e._v(e._s(e._f("plural")(t.plots_count,"Plot","Plots")))]),e._v(" "),a("td",[e._v(e._s(e._f("plural")(t.plants_count,"Plant","Plants")))]),e._v(" "),a("td",[t.last_measured_at?a("span",[e._v("\n                            "+e._s(e.moment(t.last_measured_at).format("MMM Do, YYYY"))+"\n                        ")]):e._e()]),e._v(" "),a("td",{staticClass:"text-right no-wrap"},[a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"View Plots",expression:"'View Plots'"}],staticClass:"show-on-hover btn btn-link btn-sm",attrs:{to:e.siteUrlPrefix+"/"+t.id}},[a("icon",{attrs:{name:"eye"}})],1),e._v(" "),e.editable||e.User.owns(t)||e.User.can("delete sites")?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Edit Site",expression:"'Edit Site'"}],staticClass:"show-on-hover btn btn-link btn-sm mr-1",on:{click:function(a){return a.preventDefault(),e.edit(t)}}},[a("icon",{attrs:{name:"create"}})],1):e._e(),e._v(" "),e.User.owns(t)||e.User.can("delete sites")?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete Site",expression:"'Delete Site'"}],staticClass:"show-on-hover btn btn-link btn-sm",on:{click:function(a){return a.preventDefault(),e.destroy(t)}}},[e.deleting!==t.id?a("icon",{attrs:{name:"trash"}}):a("inline-spinner",{staticClass:"text-primary"})],1):e._e()],1)])})),0)]):e._e()])]),e._v(" "),a("pager",{attrs:{"last-page":e.lastPage,page:e.page},on:{change:function(t){return e.goTo(t)}}}),e._v(" "),e.showSiteForm?a("site-form",{attrs:{site:e.site,groupURL:""},on:{close:e.closeForm,create:function(t){return e.siteCreated(t)},update:function(t){return e.siteUpdated(t)}}}):e._e()],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Site Name")]),this._v(" "),t("th",[this._v("From")]),this._v(" "),t("th")])])}],!1,null,"7f4ada4e",null);t.a=h.exports},mBzz:function(e,t,a){"use strict";var n=a("P1tU"),s={name:"TokensField",props:{options:{required:!0,type:Array},id:{required:!1,type:String},value:{required:!1,type:Array},tags:{required:!1,type:Boolean,default:!1},disabled:{required:!1,type:Boolean,default:!1},placeholder:{required:!1,type:String,default:"Search..."}},components:{Select2:n.a},data:function(){return{selects:[]}},watch:{value:function(){this.selects=this.value}},methods:{onChange:function(e){this.$emit("input",e)}}},r=(a("N0V6"),a("KHd+")),o=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"form-group"},[a("Select2",{attrs:{id:e.id+"_select",options:e.options,placeholder:e.placeholder,disabled:e.disabled,settings:{multiple:"true",tags:e.tags,theme:"bootstrap4"}},on:{change:function(t){return e.onChange(t)}},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)])}),[],!1,null,"23dc7042",null);t.a=o.exports},mXro:function(e,t,a){"use strict";var n=a("cv7c"),s={name:"Dropdown",components:{InlineSpinner:a("TTxJ").a,Icon:n.a},props:{options:{required:!0,type:Array},value:{required:!1,default:null},placeholder:{required:!1,type:String,default:"Select"},emptyMessage:{required:!1,type:String,default:"No results found. Try adjusting your search terms."},endMessage:{required:!1,type:String,default:""},disabled:{required:!1,type:Boolean,default:!1},autocomplete:{required:!1,type:Boolean,default:!1},loading:{required:!1,type:Boolean,default:!1},error:{required:!1,type:Boolean,default:!1},maxWidth:{required:!1,type:Number,default:230},btnClass:{required:!1,type:String,default:"btn-select"},total:{required:!1,type:Number,default:0},lengthToSearch:{required:!1,type:Number,default:0},searchMessage:{required:!1,type:String,default:""}},data:function(){return{index:null}},computed:{selected:function(){return null===this.index||0===this.options.length?this.placeholder:this.options[this.index]?this.options[this.index].label:this.placeholder}},mounted:function(){this.setIndex()},watch:{options:{handler:function(){this.setIndex()},deep:!0},value:function(){this.setIndex()}},methods:{setIndex:function(){if(null!==this.value)for(var e=this.options,t=0;t<e.length;t++)if(this.value===e[t].value)return void(this.index=t)},select:function(e,t){this.$emit("input",e.value),this.index=t},focus:function(){var e=this;this.autocomplete&&setTimeout((function(){e.$refs.search.focus(),e.$refs.search.select()}),100)},clear:function(){this.$emit("input",null),this.index=null},down:function(){var e=$(this.$refs.menu).find(".dropdown-item").first();e.length&&e.focus()},up:function(e){this.autocomplete&&0===e&&this.focus()}}},r=a("KHd+"),o=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dropdown autocomplete"},[a("button",{ref:"btn",staticClass:"font-weight-normal",class:["btn","d-flex",e.btnClass,{"btn-placeholder-effect":null===e.value,"btn-select-active":null!==e.value,"border-danger":e.error}],attrs:{"data-toggle":"dropdown","data-boundary":"window",disabled:e.disabled,"data-flip":"false"},on:{click:function(t){return e.focus()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.focus()}}},[a("span",{staticClass:"text-case-normal"},[e._v("\n      "+e._s(e.selected)+"\n    ")]),e._v(" "),e.loading?a("inline-spinner",{staticClass:"ml-auto text-primary"}):a("icon",{staticClass:"ml-auto btn-dropdown-icon",attrs:{name:"caret-down"}})],1),e._v(" "),a("div",{ref:"menu",staticClass:"dropdown-menu w-100",style:"max-width: "+e.maxWidth+"px;"},[e.autocomplete?a("div",{staticClass:"pb-2 px-3"},[a("input",{ref:"search",staticClass:"form-control form-control-sm",attrs:{type:"search",placeholder:"Search...",title:"Search"},on:{keyup:function(t){return e.$emit("search",t.target.value)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.down()},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.options.length>0&&e.select(e.options[0],0)}]}})]):e._e(),e._v(" "),e._t("header"),e._v(" "),e._l(e.options,(function(t,n){return a("a",{class:["dropdown-item",{active:t.value===e.value}],attrs:{href:"#"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.up(n)},click:function(a){return a.preventDefault(),e.select(t,n)}}},[e._v("\n      "+e._s(t.label)+"\n    ")])})),e._v(" "),e._t("default"),e._v(" "),0===e.options.length&&e.value<e.lengthToSearch&&e.searchMessage?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[e._v("\n      "+e._s(e.searchMessage)+"\n    ")]):e.options.length<e.total?a("p",{staticClass:"text-muted text-center p-2 mb-0"},[e._v("\n      "+e._s("Showing "+e.options.length+" of "+e.total+". Please search to see more")+"\n    ")]):0===e.options.length&&e.emptyMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[e._v(e._s(e.emptyMessage))]):e.endMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[a("small",[e._v(e._s(e.endMessage))])]):e._e(),e._v(" "),e._t("footer")],2)])}),[],!1,null,"e075cf5c",null);t.a=o.exports},muzd:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,".editable[data-v-553a1c4d]:focus {\n  outline: none;\n}\n.editable.editable-focused[data-v-553a1c4d] {\n  border-bottom-color: #2EB07A !important;\n}",""])},"s/Td":function(e,t,a){"use strict";var n=a("8ORw");a.n(n).a},uHij:function(e,t,a){"use strict";var n=a("o0o1"),s=a.n(n),r=a("klO2"),o=a("JUFj"),i=a("wXy6"),c=a("vQtE"),l=a("1MU1"),u=a("mS+z"),d=a("yoRh"),p=a("ke3Z"),f=a("MEn4"),m={name:"EditableContent",components:{Required:f.a},props:{value:{type:String},required:{type:Boolean},allowNewline:{type:Boolean,default:!0},bordered:{type:Boolean,default:!0}},mounted:function(){this.$refs.input.innerText=this.value},watch:{value:function(){this.focused||(this.$refs.input.innerText=this.value)}},data:function(){return{focused:!1}},methods:{change:function(e){this.$emit("input",e.target.innerText)},blur:function(){this.focused=!1,this.$emit("blur")},preventNewline:function(e){return!!this.allowNewline||(e&&e.preventDefault?(e.preventDefault(),this.$refs.content.blur(),!1):void 0)},focus:function(){this.$refs.content.focus(),this.$refs.content.select()}}},v=(a("s/Td"),a("KHd+")),h={name:"Autocomplete",components:{EditableContent:Object(v.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"content",class:["form-control","editable",{"editable-focused":e.focused}],attrs:{contenteditable:"true"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.preventNewline(t)},focus:function(t){e.focused=!0},blur:function(t){return e.blur()},input:function(t){return e.change(t)}}},[a("span",{ref:"input"}),e._v(" "),!e.focused&&e.required?a("required"):e._e()],1)}),[],!1,null,"553a1c4d",null).exports},props:{right:{required:!1,default:!1,type:Boolean},value:{required:!1},options:{required:!0,type:Array},searchValue:{required:!0,type:String},emptyMessage:{required:!1,type:String,default:"No results found. Try adjusting your search terms."},endMessage:{required:!1,type:String,default:""},placeholder:{required:!1,type:String,default:"Search"},disabled:{required:!1,type:Boolean,default:!1}},data:function(){return{autocomplete:Math.random()%1e6,search:""}},mounted:function(){this.search=this.searchValue},watch:{search:function(e){this.$emit("search",e)}},methods:{select:function(e){this.$emit("input",e),this.search=e.search||e.label},clear:function(){this.search="",this.$emit("input",null)}}},_=Object(v.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dropdown autocomplete"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],class:["form-control",{disabled:e.disabled}],attrs:{type:"text",name:"search",placehoder:e.placeholder,"aria-haspopup":"true","aria-expanded":"false",disabled:e.disabled,"data-flip":"false","aria-autocomplete":"none",autocomplete:e.autocomplete,"data-toggle":"dropdown"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),e._v(" "),a("div",{class:["dropdown-menu","w-100",{"dropdown-menu-right":e.right}]},[e._l(e.options,(function(t){return a("a",{class:["dropdown-item",{active:t.value===e.value}],attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.select(t)}}},[e._v("\n            "+e._s(t.label)+"\n        ")])})),e._v(" "),0===e.options.length&&e.emptyMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[e._v(e._s(e.emptyMessage))]):e._e(),e._v(" "),e.endMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[a("small",[e._v(e._s(e.endMessage))])]):e._e()],2)])}),[],!1,null,"b8753710",null).exports,g=a("mXro"),b=a("TTxJ"),y=a("mBzz"),x=a("cv7c");function w(e,t,a,n,s,r,o){try{var i=e[r](o),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,s)}function C(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){w(r,n,s,o,i,"next",e)}function i(e){w(r,n,s,o,i,"throw",e)}o(void 0)}))}}function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){q(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $={name:"SiteForm",components:{InlineSpinner:b.a,Dropdown:g.a,Autocomplete:_,Required:f.a,Close:d.a,ModalFooter:u.a,ModalBody:l.a,ModalTitle:c.a,ModalHeader:i.a,ModalCard:o.a,Modal:r.a,TokensField:y.a,Icon:x.a},props:{site:{required:!1,default:null}},data:function(){return{saving:!1,states:[],stateSearch:"",counties:[],countySearch:"",species:[],speciesOptions:[],types:[],form:new p.a({state_id:null,county_id:null,city:"",name:"",diameter:"",basal_area:"",owner_name:"",owner_contact:"",species:[],shrubs:[]}),speciesForm:new p.a({name:"",plant_type_id:null}),stateRequest:null,countyRequest:null,loadingStates:!1,loadingCounties:!1,createSpecies:!1}},mounted:function(){this.site&&this.form.setDefault(k(k({},this.site),{},{species:this.site.species.map((function(e){var t=e.id;return"".concat(t)})),shrubs:this.site.shrubs.map((function(e){var t=e.id;return"".concat(t)}))})),this.loadStates(),this.loadSpecies()},watch:{stateSearch:function(){this.loadStates()},countySearch:function(){this.loadCounties()},createSpecies:function(){0===this.types.length&&this.loadTypes()}},methods:{loadStates:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingStates=!0,null!==e.stateRequest&&e.stateRequest(),t.prev=2,t.next=5,axios.get("/web/states",{params:{search:e.stateSearch},cancelToken:new axios.CancelToken((function(t){return e.stateRequest=t}))});case 5:a=t.sent,n=a.data,e.states=n.data.map((function(e){return{label:"".concat(e.name," (").concat(e.code,")"),value:e.id,search:e.name}})),e.loadingStates=!1,e.form.state_id&&e.loadCounties(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),axios.isCancel(t.t0)||(e.loadingStates=!1,console.error(t.t0));case 15:e.stateRequest=null;case 16:case"end":return t.stop()}}),t,null,[[2,12]])})))()},loadCounties:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingCounties=!0,null!==e.countyRequest&&e.countyRequest(),t.prev=2,t.next=5,axios.get("/web/counties",{params:{state_id:e.form.state_id,search:e.countySearch},cancelToken:new axios.CancelToken((function(t){return e.countyRequest=t}))});case 5:a=t.sent,n=a.data,e.counties=n.data.map((function(e){return{label:e.name,value:e.id}})),e.loadingCounties=!1,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),axios.isCancel(t.t0)||(e.loadingCounties=!1,console.error(t.t0));case 14:e.countyRequest=null;case 15:case"end":return t.stop()}}),t,null,[[2,11]])})))()},loadSpecies:function(){var e=this;return C(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.request&&e.request(),axios.get("/web/species",{params:{cancelToken:new axios.CancelToken((function(t){return e.request=t})),limit:500}}).then((function(t){e.speciesOptions=t.data.data.map((function(e){return{id:e.id,text:e.name}}))})).catch((function(e){console.error(e)}));case 2:case"end":return t.stop()}}),t)})))()},loadTypes:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingTypes=!0,t.prev=1,t.next=4,axios.get("/web/plant-types");case 4:a=t.sent,n=a.data,e.types=n,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e.$alert("Unable to load form. Please try refreshing the page.");case 12:e.loadingTypes=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},onChange:function(e){this.$emit("input",e)},selectState:function(e){this.loadCounties(),this.$refs.county.clear()},save:function(){this.site?this.update():this.submit()},saveSpecies:function(){var e=this;return C(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.speciesForm.post("/web/species");case 4:a=t.sent,a.data,e.createSpecies=!1,e.loadSpecies(),e.$notify({text:"Species created successfully",type:"success"}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),t.t0.response&&422!==t.t0.response.status&&e.$notify({text:"Unable to save species. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 15:e.saving=!1;case 16:case"end":return t.stop()}}),t,null,[[1,11]])})))()},update:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.form.put("/web/sites/".concat(e.site.id));case 4:a=t.sent,n=a.data,e.$emit("update",n),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status?e.$notify({text:"One or more fields need your attention. Please review the form.",type:"error"}):e.$notify({text:"Unable to save site. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 13:e.saving=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},submit:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.form.post("/web/sites");case 4:a=t.sent,n=a.data,e.$emit("create",n),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&422!==t.t0.response.status&&e.$notify({text:"Unable to save site. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 13:e.saving=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()}}},P=Object(v.a)($,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{medium:""},on:{close:function(t){return e.$emit("close")}}},[a("form",{attrs:{action:""},on:{submit:function(t){t.preventDefault(),e.createSpecies?e.saveSpecies():e.save()}}},[a("modal-card",[a("modal-header",[e.createSpecies?a("modal-title",[e._v("Create Species")]):e.site?e.site?a("modal-title",[e._v("Update "+e._s(e.site.name))]):e._e():a("modal-title",[e._v("Add a New Site")]),e._v(" "),a("close",{on:{click:function(t){return e.$emit("close")}}})],1),e._v(" "),a("modal-body",[e.createSpecies?a("div",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"species-name"}},[e._v("\n                            Name\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.speciesForm.name,expression:"speciesForm.name"}],ref:"species-name",staticClass:"form-control",class:{"is-invalid":e.form.errors.has("species_name")},attrs:{type:"text",autofocus:"",placeholder:"Species Name",name:"species-name",id:"species-name"},domProps:{value:e.speciesForm.name},on:{input:function(t){t.target.composing||e.$set(e.speciesForm,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("species_name")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("name"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"plant"}},[e._v("\n                            Plant Type\n                            "),a("required")],1),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.speciesForm.plant_type_id,expression:"speciesForm.plant_type_id"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("plant_type_id")},attrs:{id:"plant",name:"plant_type_id",disabled:e.loadingTypes},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.speciesForm,"plant_type_id",t.target.multiple?a:a[0])}}},[a("option",{domProps:{value:null}},[e._v("None")]),e._v(" "),e._l(e.types,(function(t){return a("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])}))],2),e._v(" "),e.form.errors.has("plant_type_id")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("plant_type_id"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("button",{staticClass:"mt-2 mb-0 btn btn-link",on:{click:function(t){t.preventDefault(),e.createSpecies=!1}}},[e._v("Cancel Species Creation")])])]):a("div",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[e._v("\n                            Site Name\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"site-name",id:"name",name:"name",placeholder:"Site Name",autofocus:""},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("name")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("name"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"form-group"},[a("label",[e._v("\n                                    State\n                                    "),a("required")],1),e._v(" "),a("dropdown",{attrs:{autocomplete:"",loading:e.loadingStates,options:e.states,placeholder:"Select a state"},on:{input:function(t){return e.selectState(t)},search:function(t){e.stateSearch=t}},model:{value:e.form.state_id,callback:function(t){e.$set(e.form,"state_id",t)},expression:"form.state_id"}}),e._v(" "),e.form.errors.has("state")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                                    "+e._s(e.form.errors.first("state"))+"\n                                ")]):e._e()],1)]),e._v(" "),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"form-group"},[a("label",[e._v("\n                                    County\n                                    "),a("required")],1),e._v(" "),a("dropdown",{ref:"county",attrs:{autocomplete:"",loading:e.loadingCounties,placeholder:"Select a County",options:e.counties,disabled:null===e.form.state_id},on:{search:function(t){e.countySearch=t}},model:{value:e.form.county_id,callback:function(t){e.$set(e.form,"county_id",t)},expression:"form.county_id"}}),e._v(" "),e.form.errors.has("county")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                                    "+e._s(e.form.errors.first("county"))+"\n                                ")]):e._e()],1)])]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"city"}},[e._v("\n                            Town\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.city,expression:"form.city"}],staticClass:"form-control",attrs:{type:"text",name:"city",id:"city",placeholder:"Type a city name"},domProps:{value:e.form.city},on:{input:function(t){t.target.composing||e.$set(e.form,"city",t.target.value)}}}),e._v(" "),e.form.errors.has("city")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("city"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"owner"}},[e._v("Owner's Name")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.owner_name,expression:"form.owner_name"}],staticClass:"form-control",attrs:{type:"text",name:"owner",id:"owner",placeholder:"Type a name"},domProps:{value:e.form.owner_name},on:{input:function(t){t.target.composing||e.$set(e.form,"owner_name",t.target.value)}}}),e._v(" "),e.form.errors.has("owner_name")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("owner_name"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"contact"}},[e._v("Contact Info")]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.owner_contact,expression:"form.owner_contact"}],staticClass:"form-control",attrs:{type:"text",name:"contact",id:"contact",placeholder:"Type contact info"},domProps:{value:e.form.owner_contact},on:{input:function(t){t.target.composing||e.$set(e.form,"owner_contact",t.target.value)}}}),e._v(" "),e.form.errors.has("owner_contact")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("owner_contact"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"mb-0 form-group"},[a("label",{attrs:{for:"species"}},[e._v("\n                            Overstory Species\n                            "),a("required")],1),e._v(" "),a("div",{staticClass:"d-flex align-items-center"},[a("tokens-field",{staticClass:"flex-grow-1",attrs:{id:"species",options:e.speciesOptions},model:{value:e.form.species,callback:function(t){e.$set(e.form,"species",t)},expression:"form.species"}}),e._v(" "),a("button",{staticClass:"mb-2 ml-2 btn btn-link flex-shrink-0",on:{click:function(t){t.preventDefault(),e.createSpecies=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("New Species")])],1)],1),e._v(" "),e.form.errors.has("species")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("species"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"mb-0 form-group"},[a("label",{attrs:{for:"shrubs"}},[e._v("\n                            Seedling or Shrub Species\n                            "),a("required")],1),e._v(" "),a("div",{staticClass:"mb-0 d-flex align-items-center"},[a("tokens-field",{staticClass:"flex-grow-1",attrs:{id:"shrubs",options:e.speciesOptions},model:{value:e.form.shrubs,callback:function(t){e.$set(e.form,"shrubs",t)},expression:"form.shrubs"}}),e._v(" "),a("button",{staticClass:"mb-2 ml-2 btn btn-link flex-shrink-0",on:{click:function(t){t.preventDefault(),e.createSpecies=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("New Species")])],1)],1),e._v(" "),e.form.errors.has("shrubs")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("shrubs"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"basal-area"}},[e._v("\n                            Approximate Basal Area\n                        ")]),e._v(" "),a("div",{staticClass:"input-group is-appended"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.basal_area,expression:"form.basal_area"}],staticClass:"form-control",attrs:{type:"text",name:"basal_area",id:"basal-area",placeholder:"Type a number"},domProps:{value:e.form.basal_area},on:{input:function(t){t.target.composing||e.$set(e.form,"basal_area",t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[e._v("ft"),a("sup",[e._v("2")]),e._v("/ac")])])]),e._v(" "),e.form.errors.has("basal_area")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("basal_area"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"diameter"}},[e._v("\n                            Average Overstory Tree Diameter\n                        ")]),e._v(" "),a("div",{staticClass:"input-group is-appended"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.diameter,expression:"form.diameter"}],staticClass:"form-control",attrs:{type:"text",name:"diameter",id:"diameter",placeholder:"Type a number"},domProps:{value:e.form.diameter},on:{input:function(t){t.target.composing||e.$set(e.form,"diameter",t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[e._v("in")])])]),e._v(" "),e.form.errors.has("diameter")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("diameter"))+"\n                        ")]):e._e()])])]),e._v(" "),a("modal-footer",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.saving}},[e.saving?a("inline-spinner"):e._e(),e._v(" "),a("span",[e._v("Save")])],1),e._v(" "),a("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Close\n                ")])])],1)],1)])}),[],!1,null,"12ff2496",null);t.a=P.exports},yJCx:function(e,t,a){"use strict";var n={name:"Pager",props:{lastPage:{required:!0,type:Number},page:{required:!0,type:Number}},methods:{previous:function(){1!==this.page&&this.$emit("change",this.page-1)},next:function(){this.lastPage!==this.page&&this.$emit("change",this.page+1)},change:function(e){this.page!==e&&this.$emit("change",e)}}},s=a("KHd+"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lastPage>1?a("nav",{attrs:{"aria-label":"Page navigation"}},[a("ul",{staticClass:"pagination justify-content-center mb-0"},[a("li",{class:["page-item",{disabled:1===e.page}]},[a("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1","aria-disabled":1===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.previous()}}},[e._v("Previous")])]),e._v(" "),e._l(e.lastPage,(function(t){return a("li",{class:["page-item",{active:e.page===t}]},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.change(t)}}},[e._v(e._s(t))])])})),e._v(" "),a("li",{class:["page-item",{disabled:e.lastPage===e.page}]},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-disabled":e.lastPage===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.next()}}},[e._v("Next")])])],2)]):e._e()}),[],!1,null,"d369b0ee",null);t.a=r.exports}}]);