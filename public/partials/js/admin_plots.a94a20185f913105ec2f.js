(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"0XfU":function(e,t,a){"use strict";var n=a("o0o1"),s=a.n(n),r=a("TTxJ"),o=a("cv7c"),i=a("Pm5W"),l=a("cQaf"),c=a("EGv3"),u=a("m/BY"),d=a("mXro"),p=a("+Gql"),m=a("ke3Z"),f=a("JUFj"),v=a("klO2"),h=a("wXy6"),_=a("vQtE"),g=a("yoRh"),b=a("1MU1"),y=a("mS+z");function x(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function w(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){x(r,n,s,o,i,"next",e)}function i(e){x(r,n,s,o,i,"throw",e)}o(void 0)}))}}var C={name:"SiteSharingForm",components:{InlineSpinner:r.a,ModalFooter:y.a,ModalBody:b.a,Dropdown:d.a,Close:g.a,ModalTitle:_.a,ModalHeader:h.a,Modal:v.a,ModalCard:f.a},props:{site:{required:!0,type:Object}},data:function(){return{total:0,userOptions:[],userSearch:"",loading:!1,form:new m.a({user_id:"",can_edit:!1}),_timer:null,_request:null}},watch:{userSearch:function(){var e=this;this._timer&&clearTimeout(this._timer),this.userSearch.length>=2?this._timer=setTimeout((function(){e.loadUsers()}),600):this.userOptions=[]}},methods:{invite:function(){var e=this;return w(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.form.post("/web/sites/".concat(e.site.id,"/invitations"));case 4:e.$emit("create"),e.form.reset(),e.$notify({text:"User invited successfully",type:"success"}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&403===t.t0.response.status?e.$alert("You are not authorized to complete this action."):t.t0.response&&422===t.t0.response.status?(a=new c.a(t.t0.response.data),e.$alert(a.toArray().join(" "))):e.$alert("Unable to process your request at this time. Please try refreshing the page or contact us."),console.error(t.t0);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},loadUsers:function(){var e=this;return w(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._request&&e._request(),t.prev=1,t.next=4,axios.get("/web/user-sites/users",{params:{search:e.userSearch.length>=2?e.userSearch:null,site_id:e.site.id},cancelToken:new axios.CancelToken((function(t){return e._request=t}))});case 4:a=t.sent,n=a.data,e.total=n.total,e.userOptions=n.data.map((function(e){return{label:e.name,value:e.id}})),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),axios.isCancel(t.t0)||(t.t0.response&&403===t.t0.response.status?e.$alert("You are not authorized to complete this action."):t.t0.response&&422===t.t0.response.status?(r=new c.a(t.t0.response.data),e.$alert(r.toArray().join(" "))):e.$alert("Unable to process your request at this time. Please try refreshing the page or contact us."),console.error(t.t0));case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))()}}},k=a("KHd+"),P=Object(k.a)(C,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{on:{close:function(t){return e.$emit("close")}}},[a("form",{attrs:{action:"#"},on:{keydown:function(t){return e.form.errors.clear(t.target.name)},submit:function(t){return t.preventDefault(),e.invite(t)}}},[a("modal-card",[a("modal-header",[a("modal-title",[e._v("Share "+e._s(e.site.name))]),e._v(" "),a("close",{on:{click:function(t){return t.preventDefault(),e.$emit("close")}}})],1),e._v(" "),a("modal-body",{staticClass:"position-static"},[a("div",{staticClass:"form-group"},[a("label",[e._v("User to Share "+e._s(e.site.name)+" With")]),e._v(" "),a("dropdown",{ref:"user",staticClass:"mb-4",attrs:{autocomplete:"",options:e.userOptions,placeholder:"Find a user",total:e.total,"length-to-search":2,"search-message":"Please enter a name or an email to begin searching."},on:{search:function(t){e.userSearch=t}},model:{value:e.form.user_id,callback:function(t){e.$set(e.form,"user_id",t)},expression:"form.user_id"}}),e._v(" "),e.form.errors.has("user_id")?a("small",{staticClass:"form-text text-danger"},[e._v("\n            "+e._s(e.form.errors.first("user_id"))+"\n          ")]):e._e()],1),e._v(" "),a("div",{staticClass:"form-group mb-0"},[a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"checkbox",id:"user-can-edit"},domProps:{checked:e.form.can_edit},on:{change:function(t){e.form.can_edit=t.target.checked}}}),e._v(" "),a("label",{staticClass:"form-check-label font-weight-normal",attrs:{for:"user-can-edit"}},[e._v("\n              Allow user to edit this site\n            ")]),e._v(" "),a("small",{staticClass:"form-text text-muted"},[e._v("\n              By checking this box, the user will be allowed to edit existing data and add new data\n            ")])])])]),e._v(" "),a("modal-footer",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading}},[e.loading?a("inline-spinner"):e._e(),e._v(" "),a("span",[e._v("Invite")])],1),e._v(" "),a("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button",disabled:e.loading},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n          Cancel\n        ")])])],1)],1)])}),[],!1,null,"5e53f8f2",null).exports;function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){q(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function O(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function T(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){O(r,n,s,o,i,"next",e)}function i(e){O(r,n,s,o,i,"throw",e)}o(void 0)}))}}var D={name:"SiteSharingCard",components:{Icon:o.a,Avatar:u.a,Dropdown:d.a,SiteSharingForm:P},props:{site:{required:!0}},data:function(){return{User:p.a,loading:!0,sharedWith:[],invitations:[],userSearch:"",showShareForm:!1}},mounted:function(){this.loadSharedUsers(),this.loadInvitations()},methods:{loadSharedUsers:function(){var e=this;return T(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("/web/user-sites/shared",{params:{site_id:e.site.id},cancelToken:new axios.CancelToken((function(t){return e.request=t}))});case 3:a=t.sent,n=a.data,e.sharedWith=n,e.loading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),axios.isCancel(t.t0)||(t.t0.response&&403===t.t0.response.status?e.$alert("You are not authorized to complete this action."):t.t0.response&&422===t.t0.response.status?(r=new c.a(t.t0.response.data),e.$alert(r.toArray().join(" "))):e.$alert("Unable to process your request at this time. Please try refreshing the page or contact us."),console.error(t.t0)),e.loading=!1;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},loadInvitations:function(){var e=this;return T(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("/web/site-invitations",{params:{site_id:e.site.id}});case 3:a=t.sent,n=a.data,e.invitations=n,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),t.t0.response&&403===t.t0.response.status?e.$alert("You are not authorized to complete this action."):t.t0.response&&422===t.t0.response.status?(r=new c.a(t.t0.response.data),e.$alert(r.toArray().join(" "))):e.$alert("Unable to process your request at this time. Please try refreshing the page or contact us."),console.error(t.t0);case 12:e.loading=!1;case 13:case"end":return t.stop()}}),t,null,[[0,8]])})))()},toggleEdit:function(e){var t=this;return T(s.a.mark((function a(){var n,r;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,axios.put("/web/user-sites/site/".concat(t.site.id,"/user/").concat(e.id,"/toggle-edit"));case 3:n=a.sent,r=n.data,t.sharedWith=t.sharedWith.map((function(t){return t.id===e.id?$($({},t),{},{can_edit:r.editable}):t})),t.$notify({type:"success",text:"Updated user permissions successfully"}),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),a.t0.response&&403===a.t0.response.status?t.$notify({text:"You are not authorized to complete this action.",type:"error"}):t.$notify({text:"Unable to change user permissions. Please try refreshing the page.",type:"error"}),console.error(a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))()},cancelShare:function(e){var t,a=this;this.$confirm({title:"Cancel sharing with ".concat(e.name),text:"This action is permanent.",onConfirm:(t=T(s.a.mark((function t(){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.delete("/web/user-sites/site/".concat(a.site.id,"/user/").concat(e.id));case 3:a.sharedWith=a.sharedWith.filter((function(t){return t.id!==e.id})),a.$notify({type:"success",text:"Canceled sharing with user successfully"}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),t.t0.response&&403===t.t0.response.status?a.$notify({text:"You are not authorized to complete this action.",type:"error"}):t.t0.response&&422===t.t0.response.status?(n=new c.a(t.t0.response.data),a.$alert(n.toArray().join(" "))):a.$notify({text:"Unable to cancel sharing. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return t.apply(this,arguments)})})},deleteInvite:function(e){var t,a=this;this.$confirm({title:"Delete ".concat(e.recipient.name,"'s Invitation"),text:"This action is permanent.",onConfirm:(t=T(s.a.mark((function t(){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.delete("/web/site/invitations/".concat(e.id));case 3:a.invitations=a.invitations.filter((function(t){return t.id!==e.id})),a.$notify({type:"success",text:"Invitation deleted successfully"}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),t.t0.response&&403===t.t0.response.status?a.$notify({text:"You are not authorized to complete this action.",type:"error"}):t.t0.response&&422===t.t0.response.status?(n=new c.a(t.t0.response.data),a.$alert(n.toArray().join(" "))):a.$notify({text:"Unable to delete invitation. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return t.apply(this,arguments)})})}}},j=Object(k.a)(D,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card mb-3"},[a("div",{staticClass:"card-body p-0"},[a("div",{staticClass:"d-flex align-items-center px-3 pt-3 pb-2"},[e._m(0),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[a("button",{staticClass:"btn btn-link",on:{click:function(t){t.preventDefault(),e.showShareForm=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("Invite")])],1)])]),e._v(" "),0===e.sharedWith.length&&0===e.invitations.length?a("p",{staticClass:"text-muted mb-2 px-3"},[e._v('\n      Click the "+ Invite" button to begin sharing sites with other users.\n    ')]):e._e(),e._v(" "),0!==e.sharedWith.length?a("div",{staticClass:"mb-2"},e._l(e.sharedWith,(function(t,n){return a("div",{staticClass:"d-flex align-items-center py-2 px-3",class:{"mt-2":0!==n}},[a("div",{staticClass:"flex-shrink-0"},[a("avatar",{attrs:{user:t,small:""}})],1),e._v(" "),a("div",{staticClass:"flex-grow-1 px-2"},[a("div",{staticClass:"mb-n1"},[e._v(e._s(t.name))]),e._v(" "),a("small",{staticClass:"text-muted"},[e._v(e._s(t.can_edit?"Allowed to edit":"Not allowed to edit"))])]),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[a("div",{staticClass:"dropdown"},[a("button",{staticClass:"btn btn-light px-2",attrs:{"data-toggle":"dropdown"}},[a("icon",{attrs:{name:"ellipsis-vertical"}})],1),e._v(" "),a("div",{staticClass:"dropdown-menu align-items-center"},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.toggleEdit(t)}}},[a("icon",{attrs:{name:t.can_edit?"close":"create"}}),e._v(" "),a("span",[e._v(e._s(t.can_edit?"Disallow user to edit":"Allow user to edit"))])],1),e._v(" "),a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.cancelShare(t)}}},[a("icon",{attrs:{name:"trash"}}),e._v(" "),a("span",[e._v("Cancel Sharing")])],1)])])])])})),0):e._e(),e._v(" "),0!==e.invitations.length?a("div",[e._m(1),e._v(" "),e._l(e.invitations,(function(t){return"pending"===t.status?a("div",{staticClass:"d-flex align-items-center py-2 px-3"},[a("div",{staticClass:"flex-shrink-0"},[a("avatar",{attrs:{user:t.recipient,small:""}})],1),e._v(" "),a("div",{staticClass:"flex-grow-1 px-2"},[a("div",{staticClass:"mb-n1"},[e._v(e._s(t.recipient.name))]),e._v(" "),a("small",{staticClass:"text-muted"},[e._v("\n            "+e._s(t.is_editable?"Allowed to edit":"Not allowed to edit")+"\n          ")])]),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete Invitation",expression:"`Delete Invitation`"}],staticClass:"btn btn-light btn-sm px-2",on:{click:function(a){return a.preventDefault(),e.deleteInvite(t)}}},[a("icon",{attrs:{name:"trash"}})],1)])]):e._e()}))],2):e._e()]),e._v(" "),e.showShareForm?a("site-sharing-form",{attrs:{site:e.site},on:{create:function(t){return e.loadInvitations()},close:function(t){e.showShareForm=!1}}}):e._e()],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"flex-grow-1"},[t("strong",[this._v("Sharing")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mb-2 text-muted px-3"},[t("strong",[this._v("Pending Invitations")])])}],!1,null,null,null).exports,N=a("C+gu");function U(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function M(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){U(r,n,s,o,i,"next",e)}function i(e){U(r,n,s,o,i,"throw",e)}o(void 0)}))}}var F={name:"BetaPlantsView",components:{Pager:a("yJCx").a,PlantForm:N.a,InlineSpinner:r.a,Icon:o.a},props:{plot:{required:!0},editable:{required:!1,type:Boolean,default:!1},siteUrlPrefix:{required:!1,type:String,default:"/app/plants"}},watch:{"plot.id":{handler:function(){this.loading=!0,this.loadPlants()}},search:function(){this.loadPlants()}},data:function(){return{User:p.a,plants:[],plant:null,showForm:!1,lastPage:1,page:1,orderBy:"tag",orderDir:"asc",request:null,total:0,deleting:null,loading:!0,search:""}},mounted:function(){this.loadPlants()},methods:{loadPlants:function(){var e=this;return M(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.request&&e.request(),t.prev=1,t.next=4,axios.get("/web/plots/".concat(e.plot.id,"/plants"),{params:{search:e.search,page:e.page,order_by:e.orderBy,order_dir:e.orderDir},cancelToken:new axios.CancelToken((function(t){return e.request=t}))});case 4:a=t.sent,n=a.data,e.plants=n.data,e.lastPage=n.last_page,e.total=n.total,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),axios.isCancel(t.t0)||(console.error(t.t0),e.$notify({text:"Unable to load plot. Please try refreshing the page.",type:"error"}));case 14:e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[1,11]])})))()},goTo:function(e){this.page=e,this.loadPlants()},created:function(e){this.closeForm(),this.loadPlants(),this.$notify({text:"Plant created successfully",type:"success"})},updated:function(e){this.closeForm(),this.plants=this.plants.map((function(t){return t.id===e.id?e:t})),this.$notify({text:"Plant updated successfully",type:"success"})},closeForm:function(){this.plant=null,this.showForm=!1},edit:function(e){this.plant=e,this.showForm=!0},destroy:function(e){var t,a=this;null===this.deleting&&this.$confirm({title:"Are you sure you want to delete Plant #".concat(e.tag,"?"),text:"This action is permanent!",onConfirm:(t=M(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.deleting=e.id,t.prev=1,t.next=4,axios.delete("/web/plants/".concat(e.id));case 4:a.loadPlants(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),a.$notify({text:"Unable to delete plant. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 11:a.deleting=null;case 12:case"end":return t.stop()}}),t,null,[[1,7]])}))),function(){return t.apply(this,arguments)})})},plotUpdated:function(e){this.plot=e,this.editingPlot=!1},sort:function(e){e===this.orderBy?this.orderDir="asc"===this.orderDir?"desc":"asc":(this.orderBy=e,this.orderDir="asc"),this.loadPlants()},sortIcon:function(e){return e!==this.orderBy?"swap-vertical":"asc"===this.orderDir?"arrow-up":"arrow-down"}}},I=Object(k.a)(F,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"card-header d-flex align-items-center p-2"},[a("div",{staticClass:"flex-grow-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Search by tag or species"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),e.editable||e.User.owns(e.plot)||e.User.can("update sites")?a("div",{staticClass:"flex-shrink-0 text-muted"},[a("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.showForm=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("Plant")])],1)]):e._e()]),e._v(" "),a("div",{staticClass:"card-body p-0 table-responsive"},[e.loading?a("div",{staticClass:"d-flex align-items-center justify-content-center"},[a("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),e.loading||0!==e.plants.length?e._e():a("div",{staticClass:"p-3 text-muted border-top"},[e._v('\n            No plants found. Please try adjusting your filters or create a new plant using the "+ Plant" button above.\n        ')]),e._v(" "),!e.loading&&e.plants.length>0?a("table",{staticClass:"table table-middle mb-0"},[a("thead",[a("tr",[a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("tag")}}},[a("span",{staticClass:"mr-1"},[e._v("Tag")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("tag")}})],1)]),e._v(" "),a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("name")}}},[a("span",{staticClass:"mr-1"},[e._v("Species")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("name")}})],1)]),e._v(" "),a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("quadrant")}}},[a("span",{staticClass:"mr-1"},[e._v("Quadrant")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("quadrant")}})],1)]),e._v(" "),a("th",[a("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("measurements_count")}}},[a("span",{staticClass:"mr-1"},[e._v("Measurements")]),e._v(" "),a("icon",{attrs:{name:e.sortIcon("measurements_count")}})],1)]),e._v(" "),a("th")])]),e._v(" "),a("tbody",e._l(e.plants,(function(t){return a("tr",[a("td",[a("router-link",{attrs:{to:e.siteUrlPrefix+"/"+t.id}},[e._v(e._s(t.type.name)+" #"+e._s(t.tag))]),e._v(" "),t.old_tag?a("p",{staticClass:"mb-0 text-muted"},[e._v(e._s("Previously "+t.old_tag))]):e._e()],1),e._v(" "),a("td",[e._v(e._s(t.species_name))]),e._v(" "),a("td",[e._v(e._s(t.quadrant))]),e._v(" "),a("td",[e._v(e._s(t.measurements_count))]),e._v(" "),a("td",[a("div",{staticClass:"d-flex justify-content-end"},[e.editable||e.User.owns(t)||e.User.can("update sites")?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Edit",expression:"'Edit'"}],staticClass:"btn btn-sm btn-link",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),e.edit(t)}}},[a("icon",{attrs:{name:"create"}})],1):e._e(),e._v(" "),e.User.owns(t)||e.User.can("delete sites")?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete",expression:"'Delete'"}],staticClass:"btn btn-sm",class:e.deleting===t.id?"btn-danger":"btn-link",attrs:{type:"button"},on:{click:function(a){return e.destroy(t)}}},[e.deleting!==t.id?a("icon",{attrs:{name:"trash"}}):a("inline-spinner")],1):e._e()])])])})),0)]):e._e(),e._v(" "),e.lastPage>1?a("div",{staticClass:"py-2"},[a("pager",{attrs:{page:e.page,"last-page":e.lastPage},on:{change:function(t){return e.goTo(t)}}})],1):e._e()]),e._v(" "),e.showForm?a("plant-form",{attrs:{plot:e.plot,plant:e.plant},on:{close:e.closeForm,create:e.created,update:e.updated}}):e._e()],1)}),[],!1,null,"405c74cd",null).exports,E=a("gdrP"),A=a("MEn4");function B(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}var R={name:"SiteForm",components:{InlineSpinner:r.a,Required:A.a,Close:g.a,ModalFooter:y.a,ModalBody:b.a,ModalTitle:_.a,ModalHeader:h.a,ModalCard:f.a,Modal:v.a},props:{site:{required:!1,default:null}},data:function(){return{form:new m.a({file:null})}},methods:{submit:function(){var e,t=this;return(e=s.a.mark((function e(){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.form.file&&t.form.setAsFile("file"),e.prev=1,e.next=4,t.form.post("/web/sites/".concat(t.site.id,"/import"));case 4:a=e.sent,n=a.data,t.$notify({type:"success",text:"Measurements imported successfully."}),t.$emit("create",n),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),e.t0.response&&422!==e.t0.response.status&&t.$notify({text:"Unable to save site. Please try refreshing the page.",type:"error"}),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){B(r,n,s,o,i,"next",e)}function i(e){B(r,n,s,o,i,"throw",e)}o(void 0)}))})()},fileChanged:function(e){this.form.file=e.target.files[0]}}},H=Object(k.a)(R,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{medium:""},on:{close:function(t){return e.$emit("close")}}},[a("form",{attrs:{action:""},on:{submit:function(t){return t.preventDefault(),e.submit()}}},[a("modal-card",[a("modal-header",[a("modal-title",[e._v("Import")]),e._v(" "),a("close",{on:{click:function(t){return e.$emit("close")}}})],1),e._v(" "),a("modal-body",[a("p",{staticClass:"text-muted"},[e._v("If you have filled out an exported data sheet, you can upload it here to automatically generate new measurements.")]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",[e._v("\n                        File Upload\n                    ")]),e._v(" "),a("div",{staticClass:"input-group mb-3"},[a("div",{staticClass:"custom-file"},[a("input",{staticClass:"custom-file-input",attrs:{type:"file",id:"fileUpload",accept:".xlsx"},on:{change:function(t){return e.fileChanged(t)}}}),e._v(" "),a("label",{staticClass:"custom-file-label",attrs:{for:"fileUpload"}},[e._v("\n                                "+e._s(e.form.file?e.form.file.name:"Choose file")+"\n                            ")])])]),e._v(" "),e._l(e.form.errors.errors,(function(t){return a("span",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(t[0])+"\n                    ")])}))],2)]),e._v(" "),a("modal-footer",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[a("span",[e._v("Import")])]),e._v(" "),a("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Close\n                ")])])],1)],1)])}),[],!1,null,"cfd010d0",null).exports;function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach((function(t){W(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function W(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function z(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function Y(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){z(r,n,s,o,i,"next",e)}function i(e){z(r,n,s,o,i,"throw",e)}o(void 0)}))}}var G={name:"BetaPlotsView",components:{InlineSpinner:r.a,PlotForm:E.a,ImportForm:H,Dropdown:d.a,BetaPlantsView:I,Tab:l.a,Tabs:i.a,Icon:o.a,SiteSharingCard:j},props:{site:{required:!0},siteUrlPrefix:{required:!1,type:String,default:"/app/plants"},editable:{required:!1,type:Boolean,default:!1}},data:function(){return{User:p.a,loading:!0,plots:[],plot:null,plotId:null,page:1,lastPage:1,search:"",orderBy:"number",orderDir:"asc",request:null,plotOptions:[],showPlotForm:!1,editing:null,deleting:null,importing:!1,userSite:null,sendReminders:!1}},watch:{"site.id":{handler:function(){this.loadPlots()}},plotId:function(e){var t=this.plots.filter((function(t){return t.id===e}));t.length>0&&(this.plot=t[0])},search:function(){this.loadPlots()}},mounted:function(){this.loadPlots(),this.User.owns(this.site)?this.sendReminders=this.site.sends_reminders:this.loadUserSite()},methods:{loadPlots:function(){var e=this;return Y(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null!==e.request&&e.request(),t.prev=1,t.next=4,axios.get("/web/sites/".concat(e.site.id,"/plots"),{params:{page:e.page,search:e.search,order_by:e.orderBy,order_dir:e.orderDir},cancelToken:new axios.CancelToken((function(t){return e.request=t}))});case 4:a=t.sent,n=a.data,e.plots=n.data,e.lastPage=n.last_page,e.loading=!1,e.request=null,(null===e.plotId||null===e.plot)&&e.plots.length>0&&(e.plotId=e.plots[0].id,e.plot=e.plots[0]),e.setOptions(),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),axios.isCancel(t.t0)||(e.loading=!1,e.request=null);case 17:case"end":return t.stop()}}),t,null,[[1,14]])})))()},loadUserSite:function(){var e=this;return Y(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("/web/user-sites/site/".concat(e.site.id));case 3:a=t.sent,n=a.data,e.userSite=n,e.sendReminders=n.sends_reminders,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),t.t0.response&&404===t.t0.response.status?e.sends_reminders=!1:(e.$notify({text:"Unable to load site information. Please try refreshing the page.",type:"error"}),console.error(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},created:function(e){this.plots.push(e),this.plot=e,this.plotId=e.id,this.setOptions(),this.closeForm(),console.log(this.plots.length)},updated:function(e){this.plot=e,this.plots=this.plots.map((function(t){return t.id===e.id?e:t})),this.setOptions(),this.closeForm()},setOptions:function(){this.plotOptions=this.plots.map((function(e){return{value:e.id,label:"Plot #".concat(e.number)}}))},closeForm:function(){this.showPlotForm=!1,this.editing=null},edit:function(){this.editing=this.plot,this.showPlotForm=!0},deletePlot:function(){var e,t=this;null===this.deleting&&this.$confirm({title:"Are you sure you want to delete Plot #".concat(this.plot.number,"?"),text:"This action is permanent!",onConfirm:(e=Y(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.deleting=t.plot.id,e.prev=1,e.next=4,axios.delete("/web/plots/".concat(t.plot.id));case 4:t.plot=null,t.loadPlots(),t.$notify({text:"Plot deleted successfully.",type:"success"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t.$notify({text:"Unable to delete plot. Please try refreshing the page.",type:"error"});case 12:t.deleting=null;case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),function(){return e.apply(this,arguments)})})},deleteSite:function(){var e,t=this;null===this.deleting&&this.$confirm({title:"Are you sure you want to delete ".concat(this.site.name,"?"),text:"This action is permanent!",onConfirm:(e=Y(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.deleting=t.site.id,e.prev=1,e.next=4,axios.delete("/web/sites/".concat(t.site.id));case 4:t.$notify({text:"Site deleted successfully",type:"error"}),t.$router.replace({path:"/app/sites",query:{}}).catch((function(e){})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.$notify({text:"Unable to delete site. Please try refreshing the page.",type:"error"});case 11:t.deleting=null;case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(){return e.apply(this,arguments)})})},optional:function(e,t){return e?Array.isArray(e)&&0!==e.length?e.map((function(e){return e.name})).join(", "):e:void 0!==t?"".concat(t," is not provided"):"Not provided"},measurementsCreated:function(){this.closeImportForm()},closeImportForm:function(){this.importing=!1},toggleReminders:function(){var e=this;return Y(s.a.mark((function t(){var a,n,r,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.User.owns(e.site)){t.next=10;break}return t.next=4,axios.put("/web/sites/".concat(e.site.id,"/toggle-reminders"));case 4:a=t.sent,n=a.data,e.site.sends_reminders=n.sends_reminders,e.sendReminders=n.sends_reminders,t.next=16;break;case 10:return t.next=12,axios.put("/web/user-sites/".concat(e.site.id,"/toggle-reminders"));case 12:r=t.sent,o=r.data,e.userSite=L(L({},e.userSite),{},{sends_reminders:o.sends_reminders}),e.sendReminders=o.sends_reminders;case 16:e.$notify({text:"Reminders updated successfully.",type:"success"}),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(0),console.error(t.t0),e.$notify({text:"Unable to update reminders. Please try refreshing the page.",type:"error"});case 23:case"end":return t.stop()}}),t,null,[[0,19]])})))()}}},K=Object(k.a)(G,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"card mb-3"},[a("div",{staticClass:"card-header d-flex"},[e._m(0),e._v(" "),e.editable||e.User.owns(e.plot)||e.User.can("update sites")?a("div",{staticClass:"flex-shrink-0"},[a("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.showPlotForm=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("Plot")])],1)]):e._e()]),e._v(" "),a("div",{staticClass:"card-body"},[a("dropdown",{attrs:{autocomplete:"",loading:e.loading,options:e.plotOptions},on:{search:function(t){e.search=t}},model:{value:e.plotId,callback:function(t){e.plotId=t},expression:"plotId"}})],1)]),e._v(" "),a("div",{staticClass:"card mb-3"},[a("div",{staticClass:"card-body"},[e._m(1),e._v(" "),a("a",{staticClass:"d-flex align-items-center",attrs:{href:"/web/sites/"+e.site.id+"/export",target:"_blank"}},[a("icon",{attrs:{name:"cloud-download-outline"}}),e._v(" "),a("span",{staticClass:"ml-2"},[e._v("Download Spreadsheet")])],1),e._v(" "),e._m(2),e._v(" "),a("a",{staticClass:"mt-3 d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.importing=!0}}},[a("icon",{attrs:{name:"cloud-upload-outline"}}),e._v(" "),a("span",{staticClass:"ml-2"},[e._v("Import Spreadsheet")])],1),e._v(" "),e._m(3),e._v(" "),a("div",{staticClass:"custom-control custom-checkbox"},[a("input",{staticClass:"custom-control-input",attrs:{id:"send-notifications",type:"checkbox"},domProps:{checked:this.sendReminders},on:{change:function(t){return t.preventDefault(),e.toggleReminders()}}}),e._v(" "),a("label",{staticClass:"custom-control-label font-weight-normal",attrs:{for:"send-notifications"}},[e._v("\n                            Receive reminders to revisit this site\n                        ")])])])]),e._v(" "),e.User.can("share sites")||e.User.owns(e.site)?a("site-sharing-card",{attrs:{site:e.site}}):e._e()],1),e._v(" "),a("div",{staticClass:"col-md-8 col-lg-9"},[a("div",{staticClass:"card mb-3"},[e.loading?e._e():a("tabs",[a("tab",{attrs:{name:"Plants",selected:""}},[e.plot?a("beta-plants-view",{attrs:{"site-url-prefix":e.siteUrlPrefix,editable:e.editable,plot:e.plot}}):a("div",[e.loading?a("div",{staticClass:"p-3 d-flex align-items-center justify-content-center"},[a("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),e.loading||0!==e.plots.length?e._e():a("div",{staticClass:"card-body d-flex align-items-center justify-content-center flex-column text-center"},[a("div",{staticClass:"d-flex align-items-center justify-content-center icon-circle"},[a("icon",{attrs:{name:"document-text-outline"}})],1),e._v(" "),a("p",{staticClass:"font-weight-bold mt-4"},[e._v("Welcome to Your Site")]),e._v(" "),a("p",{staticClass:"text-muted max-w-700"},[e._v("\n                                    In this page, you will be able to create and manage plots for your site.\n                                ")]),e._v(" "),a("p",{staticClass:"text-muted max-w-700"},[e._v("\n                                    Get started by creating a new plot using the button below.\n                                ")]),e._v(" "),a("button",{staticClass:"btn btn-primary mt-4",on:{click:function(t){t.preventDefault(),e.showPlotForm=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("\n                                        New Plot\n                                    ")])],1)])])],1),e._v(" "),e.plot?a("tab",{attrs:{name:"Plot Info"}},[a("div",{staticClass:"card-header border-bottom d-flex"},[a("div",{staticClass:"flex-grow-1"},[a("strong",[e._v("Plot Information")])]),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[e.editable||e.User.owns(e.plot)||e.User.can("update sites")?a("button",{staticClass:"btn btn-link",on:{click:function(t){return t.preventDefault(),e.edit(t)}}},[a("icon",{attrs:{name:"create"}}),e._v(" "),a("span",[e._v("Edit Plot")])],1):e._e(),e._v(" "),e.User.owns(e.plot)||e.User.can("delete sites")?a("button",{staticClass:"btn btn-link",on:{click:function(t){return t.preventDefault(),e.deletePlot(t)}}},[e.deleting!==e.plot.id?a("icon",{attrs:{name:"trash"}}):a("inline-spinner"),e._v(" "),a("span",[e._v("Delete Plot")])],1):e._e()])]),e._v(" "),a("div",{staticClass:"card-body"},[e.plot?a("dl",{staticClass:"mb-0"},[a("dt",[e._v("Basal Area")]),e._v(" "),null!==e.plot.basal_area?a("dd",[e._v(e._s(e.plot.basal_area))]):a("dd",[e._v("Not Provided")]),e._v(" "),a("dt",[e._v("Enclosed or Protected")]),e._v(" "),e.plot.is_protected?a("dd",[e._v("Yes")]):a("dd",[e._v("No")]),e._v(" "),a("dt",[e._v("Protection Period")]),e._v(" "),null!==e.plot.protection_seasons?a("dd",[e._v(e._s(e.plot.protection_seasons))]):a("dd",[e._v("Not Provided")]),e._v(" "),a("dt",[e._v("Ground and Shrub Cover")]),e._v(" "),null!==e.plot.ground_cover?a("dd",[e._v(e._s(e.plot.ground_cover))]):a("dd",[e._v("Not Provided")]),e._v(" "),a("dt",[e._v("Canopy")]),e._v(" "),null!==e.plot.canopy?a("dd",[e._v(e._s(e.plot.canopy))]):a("dd",[e._v("Not Provided")]),e._v(" "),a("dt",[e._v("Subcanopy")]),e._v(" "),null!==e.plot.subcanopy?a("dd",[e._v(e._s(e.plot.subcanopy))]):a("dd",[e._v("Not Provided")]),e._v(" "),a("dt",[e._v("Recorders")]),e._v(" "),null!==e.plot.recorders?a("dd",[e._v(e._s(e.plot.recorders))]):a("dd",[e._v("Not Provided")]),e._v(" "),a("dt",[e._v("Wildlife Management Unit")]),e._v(" "),e.plot.wmu?a("dd",[e._v(e._s(e.plot.wmu))]):a("dd",[e._v("Not Provided")])]):e._e()])]):e._e(),e._v(" "),a("tab",{attrs:{name:"Site Info"}},[a("div",{staticClass:"card-header border-bottom d-flex"},[a("div",{staticClass:"flex-grow-1"},[a("strong",[e._v("Site Information")])]),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[e.editable||e.User.owns(e.site)||e.User.can("update sites")?a("button",{staticClass:"btn btn-link",on:{click:function(t){return t.preventDefault(),e.$emit("edit-site-request")}}},[a("icon",{attrs:{name:"create"}}),e._v(" "),a("span",[e._v("Edit Site")])],1):e._e()]),e._v(" "),a("div",{staticClass:"flex-shrink-0"},[e.User.owns(e.site)||e.User.can("delete sites")?a("button",{staticClass:"btn btn-link",on:{click:function(t){return t.preventDefault(),e.deleteSite(t)}}},[e.deleting!==e.site.id?a("icon",{attrs:{name:"trash"}}):a("inline-spinner"),e._v(" "),a("span",[e._v("Delete Site")])],1):e._e()])]),e._v(" "),a("div",{staticClass:"card-body"},[a("dl",{staticClass:"mb-0"},[a("dt",[e._v("Owner")]),e._v(" "),a("dd",{staticClass:"text-muted"},[e._v(e._s(e.optional(e.site.owner_name,"Owner name")))]),e._v(" "),a("dt",[e._v("Contact Info")]),e._v(" "),a("dd",{staticClass:"text-muted"},[e._v("\n                                    "+e._s(e.optional(e.site.owner_contact,"Owner contact info"))+"\n                                ")]),e._v(" "),a("dt",[e._v("Overstory Species")]),e._v(" "),0!==e.site.species.length?a("dd",{staticClass:"text-muted"},[e._v("\n                                    "+e._s(e.site.species.map((function(e){return e.name})).join(", "))+"\n                                ")]):a("dd",{staticClass:"text-muted"},[e._v("Not provided")]),e._v(" "),a("dt",[e._v("Seedling or Shrub Species")]),e._v(" "),0!==e.site.shrubs.length?a("dd",{staticClass:"text-muted"},[e._v("\n                                    "+e._s(e.site.shrubs.map((function(e){return e.name})).join(", "))+"\n                                ")]):a("dd",{staticClass:"text-muted"},[e._v("Not provided")]),e._v(" "),a("dt",[e._v("Basal Area")]),e._v(" "),a("dd",{staticClass:"text-muted"},[e._v("\n                                    "+e._s(e.optional(e.site.basal_area))+"\n                                    "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.site.basal_area,expression:"site.basal_area"}]},[e._v("ft"),a("sup",[e._v("2")]),e._v("/ac")])]),e._v(" "),a("dt",[e._v("Average Overstory Tree Diameter")]),e._v(" "),a("dd",{staticClass:"text-muted"},[e._v(e._s(e.optional(e.site.diameter))+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.site.diameter,expression:"site.diameter"}]},[e._v("in")])])])])])],1)],1)])]),e._v(" "),e.importing?a("import-form",{attrs:{site:e.site},on:{close:e.closeImportForm,create:function(t){return e.measurementsCreated()}}}):e._e(),e._v(" "),e.showPlotForm?a("plot-form",{attrs:{site:e.site,plot:e.editing},on:{create:function(t){return e.created(t)},update:function(t){return e.updated(t)},close:e.closeForm}}):e._e()],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"flex-grow-1"},[t("strong",[this._v("Plots")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pb-2"},[t("strong",[this._v("Actions")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mb-2"},[t("small",{staticClass:"text-muted"},[this._v("The produced spreadsheet can be filled and imported into the site")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mb-4"},[t("small",{staticClass:"text-muted"},[this._v("Import data recorded in spreadsheet format")])])}],!1,null,"9dabaed0",null).exports;function X(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}var Q={name:"PlotsDataView",components:{SiteForm:a("uHij").a,Icon:o.a,BetaPlotsView:K,InlineSpinner:r.a},props:{siteUrlPrefix:{required:!1,type:String,default:"/app/plants"},editable:{required:!1,type:Boolean,default:!1}},data:function(){return{loadingSite:!0,site:null,plots:[],loadingPlots:!1,plotSearch:"",plants:[],loadingPlants:!1,showForm:!1}},mounted:function(){this.loadSite()},methods:{loadSite:function(){var e,t=this;return(e=s.a.mark((function e(){var a,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingSite=!0,e.prev=1,a=t.$route.params.id,e.next=5,axios.get("/web/sites/".concat(a));case 5:n=e.sent,r=n.data,t.site=r,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0),t.$alert("Unable to load site information. Please try refreshing the page.");case 14:t.loadingSite=!1;case 15:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){X(r,n,s,o,i,"next",e)}function i(e){X(r,n,s,o,i,"throw",e)}o(void 0)}))})()},edit:function(){this.showForm=!0},updated:function(e){this.site=e,this.showForm=!1}}},V=Object(k.a)(Q,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loadingSite?a("div",{staticClass:"d-flex align-items-center justify-content-center"},[a("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),e.site&&!e.loadingSite?a("div",{staticClass:"mb-3 d-flex"},[a("div",{staticClass:"flex-grow-1"},[a("h1",{staticClass:"page-title"},[e._v("\n                "+e._s(e.site.name)+"\n            ")]),e._v(" "),a("p",{staticClass:"mb-0 text-muted"},[e._v("\n                "+e._s(e.site.city?e.site.city+", ":"")+e._s(e.site.county.name)+", "+e._s(e.site.state.name)+"\n            ")])])]):e._e(),e._v(" "),e.site?a("beta-plots-view",{attrs:{site:e.site,"site-url-prefix":e.siteUrlPrefix,editable:e.editable},on:{"edit-site-request":e.edit}}):e._e(),e._v(" "),e.showForm?a("site-form",{attrs:{site:e.site},on:{close:function(t){e.showForm=!1},update:e.updated}}):e._e()],1)}),[],!1,null,"511ccd47",null);t.a=V.exports},"8ORw":function(e,t,a){var n=a("muzd");"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,s);n.locals&&(e.exports=n.locals)},"8sR4":function(e,t,a){"use strict";a.r(t);var n={name:"AdminPlots",components:{PlotsDataView:a("0XfU").a}},s=a("KHd+"),r=Object(s.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("plots-data-view",{attrs:{"site-url-prefix":"/app/admin/plants"}})],1)}),[],!1,null,"41523912",null);t.default=r.exports},"C+gu":function(e,t,a){"use strict";var n=a("o0o1"),s=a.n(n),r=a("ke3Z"),o=a("MEn4"),i=a("klO2"),l=a("JUFj"),c=a("wXy6"),u=a("1MU1"),d=a("mS+z"),p=a("vQtE"),m=a("yoRh"),f=a("mXro"),v=a("TTxJ"),h=a("cv7c"),_=a("QEud"),g=a.n(_),b=a("wd/R"),y=a.n(b);function x(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function w(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){x(r,n,s,o,i,"next",e)}function i(e){x(r,n,s,o,i,"throw",e)}o(void 0)}))}}var C={name:"PlantForm",components:{DatePicker:g.a,InlineSpinner:v.a,Dropdown:f.a,Close:m.a,ModalTitle:p.a,ModalFooter:d.a,ModalBody:u.a,ModalHeader:c.a,ModalCard:l.a,Modal:i.a,Required:o.a,Icon:h.a},props:{plot:{required:!1,type:Object},plant:{required:!1,type:Object}},watch:{speciesSearch:function(){this.loadSpecies()},date:function(e){this.form.date=e?y()(e).format("YYYY-MM-DD"):null},"form.species_id":{handler:function(){this.form.errors.clear("species_id")}},"form.plant_type_id":{handler:function(){this.loadSpecies()}}},data:function(){var e=window.avid.last_entry;return{plants:[],saving:!1,date:e?y()(e).toDate():null,form:new r.a({new_measurement:!1,date:window.avid.last_entry,height:"",new_species:!1,new_species_name:"",plant_type_id:"",tag:"",species_id:"",quadrant:""}),loadingPlants:!1,loadingSpecies:!1,species:[],speciesSearch:""}},mounted:function(){var e=this;return w(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadTypes();case 2:e.plant&&e.form.setDefault(e.plant);case 3:case"end":return t.stop()}}),t)})))()},methods:{loadTypes:function(){var e=this;return w(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingPlants=!0,t.prev=1,t.next=4,axios.get("/web/plant-types");case 4:return a=t.sent,n=a.data,e.plants=n,e.form.plant_type_id=n[0].id,t.next=10,e.loadSpecies();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),e.$alert("Unable to load form. Please try refreshing the page.");case 15:e.loadingPlants=!1;case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()},loadSpecies:function(){var e=this;return w(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("/web/species",{params:{search:e.speciesSearch,plant_type_id:e.form.plant_type_id}});case 3:a=t.sent,n=a.data,e.species=n.data.map((function(e){return{label:e.name,value:e.id}})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},save:function(){this.plant?this.update():this.create()},create:function(){var e=this;return w(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.form.post("/web/plots/".concat(e.plot.id,"/plants"));case 4:a=t.sent,n=a.data,e.$emit("create",n),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status||e.$notify({text:"Unable to create plant. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 13:e.saving=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},update:function(){var e=this;return w(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.form.put("/web/plants/".concat(e.plant.id));case 4:a=t.sent,n=a.data,e.$emit("update",n),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status||e.$notify({text:"Unable to create plant. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 13:e.saving=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()}}},k=a("KHd+"),P=Object(k.a)(C,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{on:{close:function(t){return e.$emit("close")}}},[a("form",{attrs:{action:"#"},on:{submit:function(t){return t.preventDefault(),e.save(t)}}},[a("modal-card",[a("modal-header",[e.plant?e._e():a("modal-title",[e._v("Add A Plant")]),e._v(" "),e.plant?a("modal-title",[e._v("Update Plant #"+e._s(e.plant.tag))]):e._e(),e._v(" "),a("close",{on:{click:function(t){return t.preventDefault(),e.$emit("close")}}})],1),e._v(" "),e.loadingPlants||e.loadingSpecies?a("modal-body",{staticClass:"d-flex justify-content-center align-items-center"},[a("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),e.loadingSpecies||e.loadingPlants?e._e():a("modal-body",{staticClass:"position-static"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"plant"}},[e._v("\n                        Plant Type\n                        "),a("required")],1),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.plant_type_id,expression:"form.plant_type_id"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("plant_type_id")},attrs:{id:"plant",name:"plant_type_id",disabled:e.loadingPlants},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"plant_type_id",t.target.multiple?a:a[0])}}},e._l(e.plants,(function(t){return a("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])})),0),e._v(" "),e.form.errors.has("plant_type_id")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("plant_type_id"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"row position-static"},[a("div",{staticClass:"form-group col-6"},[a("label",{attrs:{for:"tag-num"}},[e._v("\n                            Tag Number\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.tag,expression:"form.tag"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("tag")},attrs:{type:"text",id:"tag-num",name:"plant_type_id",placeholder:"Tag #"},domProps:{value:e.form.tag},on:{input:function(t){t.target.composing||e.$set(e.form,"tag",t.target.value)}}}),e._v(" "),e.form.errors.has("tag")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("tag"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group col-6 position-static"},[a("label",{attrs:{for:"quadrant"}},[e._v("\n                            Quadrant\n                            "),a("required")],1),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.quadrant,expression:"form.quadrant"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("quadrant")},attrs:{name:"quadrant",id:"quadrant"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"quadrant",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select a Quadrant")]),e._v(" "),a("option",{attrs:{value:"Northeast"}},[e._v("Northeast")]),e._v(" "),a("option",{attrs:{value:"Northwest"}},[e._v("Northwest")]),e._v(" "),a("option",{attrs:{value:"Southeast"}},[e._v("Southeast")]),e._v(" "),a("option",{attrs:{value:"Southwest"}},[e._v("Southwest")])]),e._v(" "),e.form.errors.has("quadrant")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("quadrant"))+"\n                        ")]):e._e()]),e._v(" "),e.form.new_species?e._e():a("div",{staticClass:"form-group col-6 position-static"},[a("label",{attrs:{for:"species"}},[e._v("\n                            Species\n                            "),a("required")],1),e._v(" "),a("dropdown",{staticClass:"mb-1",attrs:{id:"species",autocomplete:!0,lodaing:e.loadingSpecies,options:e.species,error:e.form.errors.has("species_id")},on:{search:function(t){e.speciesSearch=t}},model:{value:e.form.species_id,callback:function(t){e.$set(e.form,"species_id",t)},expression:"form.species_id"}}),e._v(" "),e.form.errors.has("species_id")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("species_id"))+"\n                        ")]):e._e()],1),e._v(" "),e.form.new_species?a("div",{staticClass:"form-group col-6 flex-column"},[a("label",{attrs:{for:"new-species"}},[e._v("\n                            Species\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.new_species_name,expression:"form.new_species_name"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("new_species_name")},attrs:{type:"text",id:"new-species",name:"new-species",placeholder:"Species Name"},domProps:{value:e.form.new_species_name},on:{input:function(t){t.target.composing||e.$set(e.form,"new_species_name",t.target.value)}}}),e._v(" "),e.form.errors.has("new_species_name")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("new_species_name"))+"\n                        ")]):e._e()]):e._e(),e._v(" "),e.form.new_species?a("button",{staticClass:"btn btn-link mt-auto mb-3 ml-3",on:{click:function(t){t.preventDefault(),e.form.new_species=!1}}},[a("span",[e._v("\n                                Cancel Species Creation\n                            ")])]):e._e()]),e._v(" "),e.form.new_species?e._e():a("p",{staticClass:"text-muted"},[e._v("\n                    If you cannot find the species from the dropdown,\n                    "),a("a",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.form.new_species=!0}}},[e._v(" you can click here to create a new one.")])]),e._v(" "),this.plant||e.form.new_measurement?e._e():a("button",{staticClass:"btn btn-link",on:{click:function(t){t.preventDefault(),e.form.new_measurement=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("Add a Measurement")])],1),e._v(" "),!this.plant&&e.form.new_measurement?a("div",{staticClass:"row position-static"},[a("div",{staticClass:"form-group col-lg-6 position-static"},[a("label",[e._v("\n                            Date\n                            "),a("required")],1),e._v(" "),a("date-picker",{attrs:{color:"green","max-date":new Date,"input-props":{class:"form-control"+(e.form.errors.has("date")?" is-invalid":""),placeholder:"Collection Date"}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),e._v(" "),e.form.errors.has("date")?a("p",{staticClass:"mb-0 form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("date"))+"\n                        ")]):e._e()],1),e._v(" "),a("div",{staticClass:"form-group col-lg-6"},[a("label",{attrs:{for:"height"}},[e._v("\n                            Height (inches)\n                            "),a("required")],1),e._v(" "),a("div",{staticClass:"input-group input-appended"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.height,expression:"form.height"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("height")},attrs:{id:"height",type:"text",placeholder:"Height"},domProps:{value:e.form.height},on:{input:function(t){t.target.composing||e.$set(e.form,"height",t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[e._v("in.")])])]),e._v(" "),e.form.errors.has("height")?a("p",{staticClass:"mb-0 form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("height"))+"\n                        ")]):e._e()])]):e._e(),e._v(" "),e.form.new_measurement?a("button",{staticClass:"btn btn-link",on:{click:function(t){t.preventDefault(),e.form.new_measurement=!1}}},[a("span",[e._v("Cancel Measurement Creation")])]):e._e()]),e._v(" "),a("modal-footer",{staticClass:"d-flex justify-content-between"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.saving}},[e.saving?a("inline-spinner"):e._e(),e._v("\n                    Save\n                ")],1),e._v(" "),a("button",{staticClass:"btn btn-light",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Cancel\n                ")])])],1)],1)])}),[],!1,null,"ebc341fa",null);t.a=P.exports},"Hp/o":function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"\n.height-auto[data-v-23dc7042] {\n    height: auto !important;\n}\n",""])},N0V6:function(e,t,a){"use strict";var n=a("NlcB");a.n(n).a},NlcB:function(e,t,a){var n=a("Hp/o");"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,s);n.locals&&(e.exports=n.locals)},Ol2u:function(e,t,a){"use strict";t.a={seasons:["0","1 to 2","Greater than or equal to 3"],percentages:["0-9%","10-19%","20-29%","30-39%","40-49%","50-59%","60-69%","70-79%","80-89%","90-100%"],hours:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],minutes:["00","05","10","15","20","25","30","35","40","45","50","55"],timezones:["EST","CST","MST","PST"],wmus:["1A","1C","2A","3A","3C","3F","3G","3H","3J","3K","3M","3N","3P","3R","3S","4A","4B","4C","4F","4G","4H","4J","4K","4L","4O","4P","4R","4S","4T","4U","4W","4Y","4Z","5A","5C","5F","5G","5H","5J","5R","5S","5T","6A","6C","6F","6G","6H","6J","6K","6N","6P","6R","6S","7A","7F","7H","7J","7M","7P","7R","7S","8A","8C","8F","8G","8H","8J","8M","8N","8P","8R","8S","8T","8W","8X","8Y","9A","9C","9F","9G","9H","9J","9K","9M","9N","9P","9R"," 9S","9T","9W","9X","9Y"]}},Pm5W:function(e,t,a){"use strict";var n={name:"Tabs",components:{Icon:a("cv7c").a},props:{history:{required:!1,type:Boolean,default:!0}},data:function(){return{tabs:[]}},mounted:function(){var e=this;this.tabs=this.$children.filter((function(e){return"tab"===e.$options._componentTag})).map((function(e){return e})),this.history&&this.tabs.forEach((function(t){e.$route.hash===t.href&&e.selectTab(t)}))},methods:{selectTab:function(e,t){e&&!this.history&&e.preventDefault(),this.tabs.forEach((function(e){e&&t&&(e.isActive=e.name===t.name)}))}}},s=a("KHd+"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"nav nav-custom-tabs align-items-center"},[e._l(e.tabs,(function(t){return a("a",{class:["nav-link",{active:t.isActive}],attrs:{href:t.href},on:{click:function(a){return e.selectTab(a,t)}}},[t.icon?a("icon",{attrs:{name:t.icon}}):e._e(),e._v(" "),a("span",[e._v(e._s(t.name))])],1)})),e._v(" "),e._t("right")],2),e._v(" "),e._t("default")],2)}),[],!1,null,null,null);t.a=r.exports},cQaf:function(e,t,a){"use strict";var n={name:"Tab",props:{name:{required:!0,type:String},selected:{default:!1,type:Boolean},icon:{required:!1,type:String,default:null}},watch:{isActive:function(e){e&&this.$emit("mount")}},data:function(){return{isActive:!1}},mounted:function(){this.isActive=this.selected},computed:{href:function(){return"#"+this.name.toLowerCase().replace(/ /g,"-").replace(/#/g,"")}}},s=a("KHd+"),r=Object(s.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return this.isActive?t("div",[this._t("default")],2):this._e()}),[],!1,null,null,null);t.a=r.exports},gdrP:function(e,t,a){"use strict";var n=a("o0o1"),s=a.n(n),r=a("klO2"),o=a("JUFj"),i=a("wXy6"),l=a("1MU1"),c=a("mS+z"),u=a("vQtE"),d=a("yoRh"),p=a("ke3Z"),m=a("MEn4"),f=a("cv7c"),v=a("Ol2u"),h=a("TTxJ");function _(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a,n;return t=e,n=[{key:"load",value:function(t){return(new e).loadMap(t)}}],(a=[{key:"loadMap",value:function(e){if(window.google&&window.google.maps)e();else{var t=document.createElement("script"),a=window.avid.keys.maps;t.async=!0,t.defer=!0,t.type="text/javascript",t.onload=e,t.src="https://maps.googleapis.com/maps/api/js?key=".concat(a),document.head.appendChild(t)}}}])&&_(t.prototype,a),n&&_(t,n),e}(),b={name:"ClickableMap",props:{value:{required:!1,type:Object,default:function(){return{latitude:40.354388,longitude:-95.998237}}}},mounted:function(){var e=this,t={latitude:40.354388,longitude:-95.998237};this.value.latitude&&this.value.longitude&&(t=this.value),g.load((function(){var a=new google.maps.LatLng(t.latitude,t.longitude);e.map=new google.maps.Map(e.$refs.map,{zoom:4,center:a}),e.updateTimeout=null,e.map.addListener("click",(function(t){e.updateTimeout=setTimeout((function(){return e.selectLocation(t)}),200)})),e.map.addListener("dblclick",(function(){clearTimeout(e.updateTimeout)}))})),this.value.latitude&&this.value.longitude&&(this.marker=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(t.latitude,t.longitude)}))},data:function(){return{pos:{latitude:40.354388,longitude:-95.998237},map:null,marker:null,updateTimeout:null}},watch:{"value.latitude":{handler:function(){this.setMarkerPosition(),this.panTo()}},"value.longitude":{handler:function(){this.setMarkerPosition(),this.panTo()}}},methods:{selectLocation:function(e){var t=e.latLng;this.$emit("input",{latitude:t.lat(),longitude:t.lng()})},setMarkerPosition:function(){var e=this.value,t=this.marker&&this.marker.getPosition();if(t){var a=t.lng(),n=t.lng();e.latitude===a&&e.longitude===n||this.marker.setPosition(new google.maps.LatLng(e.latitude,e.longitude))}else this.marker=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(e.latitude,e.longitude)})},panTo:function(){var e=this.value;e.latitude&&e.longitude&&this.map.panTo(new google.maps.LatLng(e.latitude,e.longitude))}}},y=a("KHd+");function x(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function w(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){x(r,n,s,o,i,"next",e)}function i(e){x(r,n,s,o,i,"throw",e)}o(void 0)}))}}var C={name:"PlotForm",components:{ClickableMap:Object(y.a)(b,(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"map",staticStyle:{height:"100px"}})}),[],!1,null,"e5b1aa0e",null).exports,InlineSpinner:h.a,Icon:f.a,Required:m.a,Close:d.a,ModalTitle:u.a,ModalFooter:c.a,ModalBody:l.a,ModalHeader:i.a,ModalCard:o.a,Modal:r.a},props:{site:{required:!1},plot:{required:!1,type:Object,default:null}},data:function(){return{loading:!1,form:new p.a({number:"",latitude:null,longitude:null,basal_area:"",ground_cover:"",subcanopy:"",canopy:"",is_protected:"",protection_seasons:"",recorders:""}),options:v.a,showMap:!1}},mounted:function(){this.plot&&this.form.setDefault(this.plot)},methods:{submit:function(){this.plot?this.update():this.create()},create:function(){var e=this;return w(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.form.post("/web/sites/".concat(e.site.id,"/plots"));case 4:a=t.sent,n=a.data,e.$notify({type:"success",text:"Plot created successfully"}),e.$emit("create",n),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status||(e.$notify({type:"error",text:"Unable to process the request. Please try refreshing the page."}),console.error(t.t0));case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))()},update:function(){var e=this;return w(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.form.put("/web/plots/".concat(e.plot.id));case 4:a=t.sent,n=a.data,e.$notify({type:"success",text:"Plot updated successfully"}),e.$emit("update",n),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status||(e.$notify({type:"error",text:"Unable to process the request. Please try refreshing the page."}),console.error(t.t0));case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))()},setGpsFromMap:function(e){this.form.latitude=e.latitude,this.form.longitude=e.longitude}}},k=Object(y.a)(C,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{medium:""},on:{close:function(t){return e.$emit("close")}}},[a("form",{on:{submit:function(t){return t.preventDefault(),e.submit()},keydown:function(t){t.target&&e.form.errors.clear(t.target.name)}}},[a("modal-card",[a("modal-header",[e.plot?a("modal-title",[e._v('Edit "Plot '+e._s(e.plot.number)+'"')]):a("modal-title",[e._v("New Plot")]),e._v(" "),a("close",{on:{click:function(t){return e.$emit("close")}}})],1),e._v(" "),a("modal-body",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"number"}},[e._v("\n                        Plot Number\n                        "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.number,expression:"form.number"}],class:["form-control",{"is-invalid":e.form.errors.has("number")}],attrs:{type:"text",name:"number",id:"number",placeholder:"E,g. 36"},domProps:{value:e.form.number},on:{input:function(t){t.target.composing||e.$set(e.form,"number",t.target.value)}}}),e._v(" "),e.form.errors.has("number")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("number"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-5"},[a("div",{staticClass:"d-flex align-items-center mb-1"},[a("div",[a("p",{staticClass:"mb-0"},[a("strong",[e._v("GPS Location")])]),e._v(" "),a("div",{staticClass:"mb-0"},[a("small",{staticClass:"text-muted"},[e._v("You may use the map to visually select the location.")])])])]),e._v(" "),a("div",{staticClass:"mb-2 form-group"},[a("label",{attrs:{for:"latitude"}},[e._v("\n                                Latitude\n                                "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.latitude,expression:"form.latitude"}],class:["form-control",{"is-invalid":e.form.errors.has("latitude")}],attrs:{type:"text",name:"latitude",id:"latitude",placeholder:"E,g. -36.898723"},domProps:{value:e.form.latitude},on:{input:function(t){t.target.composing||e.$set(e.form,"latitude",t.target.value)}}}),e._v(" "),e.form.errors.has("latitude")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                                "+e._s(e.form.errors.first("latitude"))+"\n                            ")]):e._e()]),e._v(" "),a("div",{staticClass:"mb-0 form-group"},[a("label",{attrs:{for:"longitude"}},[e._v("\n                                Longitude\n                                "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.longitude,expression:"form.longitude"}],class:["form-control",{"is-invalid":e.form.errors.has("longitude")}],attrs:{type:"text",name:"longitude",id:"longitude",placeholder:"E,g. -36.898723"},domProps:{value:e.form.longitude},on:{input:function(t){t.target.composing||e.$set(e.form,"longitude",t.target.value)}}}),e._v(" "),e.form.errors.has("longitude")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                                "+e._s(e.form.errors.first("longitude"))+"\n                            ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("small",{staticClass:"text-muted"},[e._v("When entering coordinates manually, please verify the location on the map")])])]),e._v(" "),a("div",{staticClass:"col-7"},[a("clickable-map",{staticClass:"map-height map-mini mb-3",attrs:{value:{latitude:e.form.latitude,longitude:e.form.longitude}},on:{input:function(t){return e.setGpsFromMap(t)}}})],1)]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"ground_cover"}},[e._v("\n                        Ground and Shrub Cover\n                        "),a("required")],1),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.ground_cover,expression:"form.ground_cover"}],class:["form-control",{"is-invalid":e.form.errors.has("ground_cover")}],attrs:{type:"text",name:"ground_cover",id:"ground_cover"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"ground_cover",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select an Option")]),e._v(" "),e._l(e.options.percentages,(function(t){return a("option",{domProps:{value:t}},[e._v("\n                                "+e._s(t)+"\n                            ")])}))],2)]),e._v(" "),e.form.errors.has("ground_cover")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("ground_cover"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"subcanopy"}},[e._v("\n                        Subcanopy\n                        "),a("required")],1),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.subcanopy,expression:"form.subcanopy"}],class:["form-control",{"is-invalid":e.form.errors.has("subcanopy")}],attrs:{type:"text",name:"subcanopy",id:"subcanopy"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"subcanopy",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select an Option")]),e._v(" "),e._l(e.options.percentages,(function(t){return a("option",{domProps:{value:t}},[e._v("\n                                "+e._s(t)+"\n                            ")])}))],2)]),e._v(" "),e.form.errors.has("subcanopy")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("subcanopy"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"canopy"}},[e._v("\n                        Canopy\n                        "),a("required")],1),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.canopy,expression:"form.canopy"}],class:["form-control",{"is-invalid":e.form.errors.has("canopy")}],attrs:{type:"text",name:"canopy",id:"canopy"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"canopy",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select an Option")]),e._v(" "),e._l(e.options.percentages,(function(t){return a("option",{domProps:{value:t}},[e._v("\n                                "+e._s(t)+"\n                            ")])}))],2)]),e._v(" "),e.form.errors.has("canopy")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("canopy"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"is_protected"}},[e._v("\n                        Is plot enclosed or protected from deer?\n                        "),a("required")],1),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.is_protected,expression:"form.is_protected"}],class:["form-control",{"is-invalid":e.form.errors.has("is_protected")}],attrs:{type:"text",name:"is_protected",id:"is_protected"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"is_protected",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select an Option")]),e._v(" "),a("option",{attrs:{value:"1"}},[e._v("Yes")]),e._v(" "),a("option",{attrs:{value:"0"}},[e._v("No")])])]),e._v(" "),e.form.errors.has("is_protected")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("is_protected"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"protection_seasons"}},[e._v("\n                        If yes, for how many growing seasons?\n                        "),a("required")],1),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.protection_seasons,expression:"form.protection_seasons"}],class:["form-control",{"is-invalid":e.form.errors.has("protection_seasons")}],attrs:{type:"text",name:"protection_seasons",id:"protection_seasons"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"protection_seasons",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select an Option")]),e._v(" "),e._l(e.options.seasons,(function(t){return a("option",{domProps:{value:t}},[e._v("\n                                "+e._s(t)+"\n                            ")])}))],2)]),e._v(" "),e.form.errors.has("protection_seasons")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("protection_seasons"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"recorders"}},[e._v("Recorders")]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.recorders,expression:"form.recorders"}],staticClass:"form-control",attrs:{type:"text",name:"recorders",id:"recorders",placeholder:"Type recorders"},domProps:{value:e.form.recorders},on:{input:function(t){t.target.composing||e.$set(e.form,"recorders",t.target.value)}}}),e._v(" "),e.form.errors.has("owner_contact")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("owner_contact"))+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"basal_area"}},[e._v("\n                        Basal Area\n                    ")]),e._v(" "),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.basal_area,expression:"form.basal_area"}],class:["form-control",{"is-invalid":e.form.errors.has("basal_area")}],attrs:{type:"text",name:"basal_area",id:"basal_area",placeholder:"E,g. 36"},domProps:{value:e.form.basal_area},on:{input:function(t){t.target.composing||e.$set(e.form,"basal_area",t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[e._v("\n                                ft"),a("sup",[e._v("2")]),e._v("/ac\n                            ")])])]),e._v(" "),e.form.errors.has("basal_area")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("basal_area"))+"\n                    ")]):e._e()])]),e._v(" "),a("modal-footer",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading}},[e.loading?a("inline-spinner"):e._e(),e._v("\n                    Save\n                ")],1),e._v(" "),a("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("Close")])])],1)],1)])}),[],!1,null,"4021509e",null);t.a=k.exports},mBzz:function(e,t,a){"use strict";var n=a("P1tU"),s={name:"TokensField",props:{options:{required:!0,type:Array},id:{required:!1,type:String},value:{required:!1,type:Array},tags:{required:!1,type:Boolean,default:!1},disabled:{required:!1,type:Boolean,default:!1},placeholder:{required:!1,type:String,default:"Search..."}},components:{Select2:n.a},data:function(){return{selects:[]}},watch:{value:function(){this.selects=this.value}},methods:{onChange:function(e){this.$emit("input",e)}}},r=(a("N0V6"),a("KHd+")),o=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"form-group"},[a("Select2",{attrs:{id:e.id+"_select",options:e.options,placeholder:e.placeholder,disabled:e.disabled,settings:{multiple:"true",tags:e.tags,theme:"bootstrap4"}},on:{change:function(t){return e.onChange(t)}},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)])}),[],!1,null,"23dc7042",null);t.a=o.exports},mXro:function(e,t,a){"use strict";var n=a("cv7c"),s={name:"Dropdown",components:{InlineSpinner:a("TTxJ").a,Icon:n.a},props:{options:{required:!0,type:Array},value:{required:!1,default:null},placeholder:{required:!1,type:String,default:"Select"},emptyMessage:{required:!1,type:String,default:"No results found. Try adjusting your search terms."},endMessage:{required:!1,type:String,default:""},disabled:{required:!1,type:Boolean,default:!1},autocomplete:{required:!1,type:Boolean,default:!1},loading:{required:!1,type:Boolean,default:!1},error:{required:!1,type:Boolean,default:!1},maxWidth:{required:!1,type:Number,default:230},btnClass:{required:!1,type:String,default:"btn-select"},total:{required:!1,type:Number,default:0},lengthToSearch:{required:!1,type:Number,default:0},searchMessage:{required:!1,type:String,default:""}},data:function(){return{index:null}},computed:{selected:function(){return null===this.index||0===this.options.length?this.placeholder:this.options[this.index]?this.options[this.index].label:this.placeholder}},mounted:function(){this.setIndex()},watch:{options:{handler:function(){this.setIndex()},deep:!0},value:function(){this.setIndex()}},methods:{setIndex:function(){if(null!==this.value)for(var e=this.options,t=0;t<e.length;t++)if(this.value===e[t].value)return void(this.index=t)},select:function(e,t){this.$emit("input",e.value),this.index=t},focus:function(){var e=this;this.autocomplete&&setTimeout((function(){e.$refs.search.focus(),e.$refs.search.select()}),100)},clear:function(){this.$emit("input",null),this.index=null},down:function(){var e=$(this.$refs.menu).find(".dropdown-item").first();e.length&&e.focus()},up:function(e){this.autocomplete&&0===e&&this.focus()}}},r=a("KHd+"),o=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dropdown autocomplete"},[a("button",{ref:"btn",staticClass:"font-weight-normal",class:["btn","d-flex",e.btnClass,{"btn-placeholder-effect":null===e.value,"btn-select-active":null!==e.value,"border-danger":e.error}],attrs:{"data-toggle":"dropdown","data-boundary":"window",disabled:e.disabled,"data-flip":"false"},on:{click:function(t){return e.focus()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.focus()}}},[a("span",{staticClass:"text-case-normal"},[e._v("\n      "+e._s(e.selected)+"\n    ")]),e._v(" "),e.loading?a("inline-spinner",{staticClass:"ml-auto text-primary"}):a("icon",{staticClass:"ml-auto btn-dropdown-icon",attrs:{name:"caret-down"}})],1),e._v(" "),a("div",{ref:"menu",staticClass:"dropdown-menu w-100",style:"max-width: "+e.maxWidth+"px;"},[e.autocomplete?a("div",{staticClass:"pb-2 px-3"},[a("input",{ref:"search",staticClass:"form-control form-control-sm",attrs:{type:"search",placeholder:"Search...",title:"Search"},on:{keyup:function(t){return e.$emit("search",t.target.value)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.down()},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.options.length>0&&e.select(e.options[0],0)}]}})]):e._e(),e._v(" "),e._t("header"),e._v(" "),e._l(e.options,(function(t,n){return a("a",{class:["dropdown-item",{active:t.value===e.value}],attrs:{href:"#"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.up(n)},click:function(a){return a.preventDefault(),e.select(t,n)}}},[e._v("\n      "+e._s(t.label)+"\n    ")])})),e._v(" "),e._t("default"),e._v(" "),0===e.options.length&&e.value<e.lengthToSearch&&e.searchMessage?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[e._v("\n      "+e._s(e.searchMessage)+"\n    ")]):e.options.length<e.total?a("p",{staticClass:"text-muted text-center p-2 mb-0"},[e._v("\n      "+e._s("Showing "+e.options.length+" of "+e.total+". Please search to see more")+"\n    ")]):0===e.options.length&&e.emptyMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[e._v(e._s(e.emptyMessage))]):e.endMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[a("small",[e._v(e._s(e.endMessage))])]):e._e(),e._v(" "),e._t("footer")],2)])}),[],!1,null,"e075cf5c",null);t.a=o.exports},muzd:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,".editable[data-v-553a1c4d]:focus {\n  outline: none;\n}\n.editable.editable-focused[data-v-553a1c4d] {\n  border-bottom-color: #2EB07A !important;\n}",""])},"s/Td":function(e,t,a){"use strict";var n=a("8ORw");a.n(n).a},uHij:function(e,t,a){"use strict";var n=a("o0o1"),s=a.n(n),r=a("klO2"),o=a("JUFj"),i=a("wXy6"),l=a("vQtE"),c=a("1MU1"),u=a("mS+z"),d=a("yoRh"),p=a("ke3Z"),m=a("MEn4"),f={name:"EditableContent",components:{Required:m.a},props:{value:{type:String},required:{type:Boolean},allowNewline:{type:Boolean,default:!0},bordered:{type:Boolean,default:!0}},mounted:function(){this.$refs.input.innerText=this.value},watch:{value:function(){this.focused||(this.$refs.input.innerText=this.value)}},data:function(){return{focused:!1}},methods:{change:function(e){this.$emit("input",e.target.innerText)},blur:function(){this.focused=!1,this.$emit("blur")},preventNewline:function(e){return!!this.allowNewline||(e&&e.preventDefault?(e.preventDefault(),this.$refs.content.blur(),!1):void 0)},focus:function(){this.$refs.content.focus(),this.$refs.content.select()}}},v=(a("s/Td"),a("KHd+")),h={name:"Autocomplete",components:{EditableContent:Object(v.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"content",class:["form-control","editable",{"editable-focused":e.focused}],attrs:{contenteditable:"true"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.preventNewline(t)},focus:function(t){e.focused=!0},blur:function(t){return e.blur()},input:function(t){return e.change(t)}}},[a("span",{ref:"input"}),e._v(" "),!e.focused&&e.required?a("required"):e._e()],1)}),[],!1,null,"553a1c4d",null).exports},props:{right:{required:!1,default:!1,type:Boolean},value:{required:!1},options:{required:!0,type:Array},searchValue:{required:!0,type:String},emptyMessage:{required:!1,type:String,default:"No results found. Try adjusting your search terms."},endMessage:{required:!1,type:String,default:""},placeholder:{required:!1,type:String,default:"Search"},disabled:{required:!1,type:Boolean,default:!1}},data:function(){return{autocomplete:Math.random()%1e6,search:""}},mounted:function(){this.search=this.searchValue},watch:{search:function(e){this.$emit("search",e)}},methods:{select:function(e){this.$emit("input",e),this.search=e.search||e.label},clear:function(){this.search="",this.$emit("input",null)}}},_=Object(v.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dropdown autocomplete"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],class:["form-control",{disabled:e.disabled}],attrs:{type:"text",name:"search",placehoder:e.placeholder,"aria-haspopup":"true","aria-expanded":"false",disabled:e.disabled,"data-flip":"false","aria-autocomplete":"none",autocomplete:e.autocomplete,"data-toggle":"dropdown"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),e._v(" "),a("div",{class:["dropdown-menu","w-100",{"dropdown-menu-right":e.right}]},[e._l(e.options,(function(t){return a("a",{class:["dropdown-item",{active:t.value===e.value}],attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.select(t)}}},[e._v("\n            "+e._s(t.label)+"\n        ")])})),e._v(" "),0===e.options.length&&e.emptyMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[e._v(e._s(e.emptyMessage))]):e._e(),e._v(" "),e.endMessage.length?a("p",{staticClass:"text-center text-muted p-2 mb-0"},[a("small",[e._v(e._s(e.endMessage))])]):e._e()],2)])}),[],!1,null,"b8753710",null).exports,g=a("mXro"),b=a("TTxJ"),y=a("mBzz"),x=a("cv7c");function w(e,t,a,n,s,r,o){try{var i=e[r](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function C(e){return function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function o(e){w(r,n,s,o,i,"next",e)}function i(e){w(r,n,s,o,i,"throw",e)}o(void 0)}))}}function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $={name:"SiteForm",components:{InlineSpinner:b.a,Dropdown:g.a,Autocomplete:_,Required:m.a,Close:d.a,ModalFooter:u.a,ModalBody:c.a,ModalTitle:l.a,ModalHeader:i.a,ModalCard:o.a,Modal:r.a,TokensField:y.a,Icon:x.a},props:{site:{required:!1,default:null}},data:function(){return{saving:!1,states:[],stateSearch:"",counties:[],countySearch:"",species:[],speciesOptions:[],types:[],form:new p.a({state_id:null,county_id:null,city:"",name:"",diameter:"",basal_area:"",owner_name:"",owner_contact:"",species:[],shrubs:[]}),speciesForm:new p.a({name:"",plant_type_id:null}),stateRequest:null,countyRequest:null,loadingStates:!1,loadingCounties:!1,createSpecies:!1}},mounted:function(){this.site&&this.form.setDefault(P(P({},this.site),{},{species:this.site.species.map((function(e){var t=e.id;return"".concat(t)})),shrubs:this.site.shrubs.map((function(e){var t=e.id;return"".concat(t)}))})),this.loadStates(),this.loadSpecies()},watch:{stateSearch:function(){this.loadStates()},countySearch:function(){this.loadCounties()},createSpecies:function(){0===this.types.length&&this.loadTypes()}},methods:{loadStates:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingStates=!0,null!==e.stateRequest&&e.stateRequest(),t.prev=2,t.next=5,axios.get("/web/states",{params:{search:e.stateSearch},cancelToken:new axios.CancelToken((function(t){return e.stateRequest=t}))});case 5:a=t.sent,n=a.data,e.states=n.data.map((function(e){return{label:"".concat(e.name," (").concat(e.code,")"),value:e.id,search:e.name}})),e.loadingStates=!1,e.form.state_id&&e.loadCounties(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),axios.isCancel(t.t0)||(e.loadingStates=!1,console.error(t.t0));case 15:e.stateRequest=null;case 16:case"end":return t.stop()}}),t,null,[[2,12]])})))()},loadCounties:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingCounties=!0,null!==e.countyRequest&&e.countyRequest(),t.prev=2,t.next=5,axios.get("/web/counties",{params:{state_id:e.form.state_id,search:e.countySearch},cancelToken:new axios.CancelToken((function(t){return e.countyRequest=t}))});case 5:a=t.sent,n=a.data,e.counties=n.data.map((function(e){return{label:e.name,value:e.id}})),e.loadingCounties=!1,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),axios.isCancel(t.t0)||(e.loadingCounties=!1,console.error(t.t0));case 14:e.countyRequest=null;case 15:case"end":return t.stop()}}),t,null,[[2,11]])})))()},loadSpecies:function(){var e=this;return C(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.request&&e.request(),axios.get("/web/species",{params:{cancelToken:new axios.CancelToken((function(t){return e.request=t})),limit:500}}).then((function(t){e.speciesOptions=t.data.data.map((function(e){return{id:e.id,text:e.name}}))})).catch((function(e){console.error(e)}));case 2:case"end":return t.stop()}}),t)})))()},loadTypes:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingTypes=!0,t.prev=1,t.next=4,axios.get("/web/plant-types");case 4:a=t.sent,n=a.data,e.types=n,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e.$alert("Unable to load form. Please try refreshing the page.");case 12:e.loadingTypes=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},onChange:function(e){this.$emit("input",e)},selectState:function(e){this.loadCounties(),this.$refs.county.clear()},save:function(){this.site?this.update():this.submit()},saveSpecies:function(){var e=this;return C(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.speciesForm.post("/web/species");case 4:a=t.sent,a.data,e.createSpecies=!1,e.loadSpecies(),e.$notify({text:"Species created successfully",type:"success"}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),t.t0.response&&422!==t.t0.response.status&&e.$notify({text:"Unable to save species. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 15:e.saving=!1;case 16:case"end":return t.stop()}}),t,null,[[1,11]])})))()},update:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.form.put("/web/sites/".concat(e.site.id));case 4:a=t.sent,n=a.data,e.$emit("update",n),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status?e.$notify({text:"One or more fields need your attention. Please review the form.",type:"error"}):e.$notify({text:"Unable to save site. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 13:e.saving=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},submit:function(){var e=this;return C(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saving=!0,t.prev=1,t.next=4,e.form.post("/web/sites");case 4:a=t.sent,n=a.data,e.$emit("create",n),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0.response&&422!==t.t0.response.status&&e.$notify({text:"Unable to save site. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 13:e.saving=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()}}},q=Object(v.a)($,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{medium:""},on:{close:function(t){return e.$emit("close")}}},[a("form",{attrs:{action:""},on:{submit:function(t){t.preventDefault(),e.createSpecies?e.saveSpecies():e.save()}}},[a("modal-card",[a("modal-header",[e.createSpecies?a("modal-title",[e._v("Create Species")]):e.site?e.site?a("modal-title",[e._v("Update "+e._s(e.site.name))]):e._e():a("modal-title",[e._v("Add a New Site")]),e._v(" "),a("close",{on:{click:function(t){return e.$emit("close")}}})],1),e._v(" "),a("modal-body",[e.createSpecies?a("div",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"species-name"}},[e._v("\n                            Name\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.speciesForm.name,expression:"speciesForm.name"}],ref:"species-name",staticClass:"form-control",class:{"is-invalid":e.form.errors.has("species_name")},attrs:{type:"text",autofocus:"",placeholder:"Species Name",name:"species-name",id:"species-name"},domProps:{value:e.speciesForm.name},on:{input:function(t){t.target.composing||e.$set(e.speciesForm,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("species_name")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("name"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"plant"}},[e._v("\n                            Plant Type\n                            "),a("required")],1),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.speciesForm.plant_type_id,expression:"speciesForm.plant_type_id"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("plant_type_id")},attrs:{id:"plant",name:"plant_type_id",disabled:e.loadingTypes},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.speciesForm,"plant_type_id",t.target.multiple?a:a[0])}}},[a("option",{domProps:{value:null}},[e._v("None")]),e._v(" "),e._l(e.types,(function(t){return a("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])}))],2),e._v(" "),e.form.errors.has("plant_type_id")?a("small",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("plant_type_id"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("button",{staticClass:"mt-2 mb-0 btn btn-link",on:{click:function(t){t.preventDefault(),e.createSpecies=!1}}},[e._v("Cancel Species Creation")])])]):a("div",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[e._v("\n                            Site Name\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"site-name",id:"name",name:"name",placeholder:"Site Name",autofocus:""},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("name")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("name"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"form-group"},[a("label",[e._v("\n                                    State\n                                    "),a("required")],1),e._v(" "),a("dropdown",{attrs:{autocomplete:"",loading:e.loadingStates,options:e.states,placeholder:"Select a state"},on:{input:function(t){return e.selectState(t)},search:function(t){e.stateSearch=t}},model:{value:e.form.state_id,callback:function(t){e.$set(e.form,"state_id",t)},expression:"form.state_id"}}),e._v(" "),e.form.errors.has("state")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                                    "+e._s(e.form.errors.first("state"))+"\n                                ")]):e._e()],1)]),e._v(" "),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"form-group"},[a("label",[e._v("\n                                    County\n                                    "),a("required")],1),e._v(" "),a("dropdown",{ref:"county",attrs:{autocomplete:"",loading:e.loadingCounties,placeholder:"Select a County",options:e.counties,disabled:null===e.form.state_id},on:{search:function(t){e.countySearch=t}},model:{value:e.form.county_id,callback:function(t){e.$set(e.form,"county_id",t)},expression:"form.county_id"}}),e._v(" "),e.form.errors.has("county")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                                    "+e._s(e.form.errors.first("county"))+"\n                                ")]):e._e()],1)])]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"city"}},[e._v("\n                            Town\n                            "),a("required")],1),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.city,expression:"form.city"}],staticClass:"form-control",attrs:{type:"text",name:"city",id:"city",placeholder:"Type a city name"},domProps:{value:e.form.city},on:{input:function(t){t.target.composing||e.$set(e.form,"city",t.target.value)}}}),e._v(" "),e.form.errors.has("city")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("city"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"owner"}},[e._v("Owner's Name")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.owner_name,expression:"form.owner_name"}],staticClass:"form-control",attrs:{type:"text",name:"owner",id:"owner",placeholder:"Type a name"},domProps:{value:e.form.owner_name},on:{input:function(t){t.target.composing||e.$set(e.form,"owner_name",t.target.value)}}}),e._v(" "),e.form.errors.has("owner_name")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("owner_name"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"contact"}},[e._v("Contact Info")]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.owner_contact,expression:"form.owner_contact"}],staticClass:"form-control",attrs:{type:"text",name:"contact",id:"contact",placeholder:"Type contact info"},domProps:{value:e.form.owner_contact},on:{input:function(t){t.target.composing||e.$set(e.form,"owner_contact",t.target.value)}}}),e._v(" "),e.form.errors.has("owner_contact")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("owner_contact"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"mb-0 form-group"},[a("label",{attrs:{for:"species"}},[e._v("\n                            Overstory Species\n                            "),a("required")],1),e._v(" "),a("div",{staticClass:"d-flex align-items-center"},[a("tokens-field",{staticClass:"flex-grow-1",attrs:{id:"species",options:e.speciesOptions},model:{value:e.form.species,callback:function(t){e.$set(e.form,"species",t)},expression:"form.species"}}),e._v(" "),a("button",{staticClass:"mb-2 ml-2 btn btn-link flex-shrink-0",on:{click:function(t){t.preventDefault(),e.createSpecies=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("New Species")])],1)],1),e._v(" "),e.form.errors.has("species")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("species"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"mb-0 form-group"},[a("label",{attrs:{for:"shrubs"}},[e._v("\n                            Seedling or Shrub Species\n                            "),a("required")],1),e._v(" "),a("div",{staticClass:"mb-0 d-flex align-items-center"},[a("tokens-field",{staticClass:"flex-grow-1",attrs:{id:"shrubs",options:e.speciesOptions},model:{value:e.form.shrubs,callback:function(t){e.$set(e.form,"shrubs",t)},expression:"form.shrubs"}}),e._v(" "),a("button",{staticClass:"mb-2 ml-2 btn btn-link flex-shrink-0",on:{click:function(t){t.preventDefault(),e.createSpecies=!0}}},[a("icon",{attrs:{name:"add"}}),e._v(" "),a("span",[e._v("New Species")])],1)],1),e._v(" "),e.form.errors.has("shrubs")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("shrubs"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"basal-area"}},[e._v("\n                            Approximate Basal Area\n                        ")]),e._v(" "),a("div",{staticClass:"input-group is-appended"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.basal_area,expression:"form.basal_area"}],staticClass:"form-control",attrs:{type:"text",name:"basal_area",id:"basal-area",placeholder:"Type a number"},domProps:{value:e.form.basal_area},on:{input:function(t){t.target.composing||e.$set(e.form,"basal_area",t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[e._v("ft"),a("sup",[e._v("2")]),e._v("/ac")])])]),e._v(" "),e.form.errors.has("basal_area")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("basal_area"))+"\n                        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"diameter"}},[e._v("\n                            Average Overstory Tree Diameter\n                        ")]),e._v(" "),a("div",{staticClass:"input-group is-appended"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.diameter,expression:"form.diameter"}],staticClass:"form-control",attrs:{type:"text",name:"diameter",id:"diameter",placeholder:"Type a number"},domProps:{value:e.form.diameter},on:{input:function(t){t.target.composing||e.$set(e.form,"diameter",t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[e._v("in")])])]),e._v(" "),e.form.errors.has("diameter")?a("span",{staticClass:"form-text text-danger"},[e._v("\n                            "+e._s(e.form.errors.first("diameter"))+"\n                        ")]):e._e()])])]),e._v(" "),a("modal-footer",{staticClass:"d-flex"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.saving}},[e.saving?a("inline-spinner"):e._e(),e._v(" "),a("span",[e._v("Save")])],1),e._v(" "),a("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Close\n                ")])])],1)],1)])}),[],!1,null,"12ff2496",null);t.a=q.exports},yJCx:function(e,t,a){"use strict";var n={name:"Pager",props:{lastPage:{required:!0,type:Number},page:{required:!0,type:Number}},methods:{previous:function(){1!==this.page&&this.$emit("change",this.page-1)},next:function(){this.lastPage!==this.page&&this.$emit("change",this.page+1)},change:function(e){this.page!==e&&this.$emit("change",e)}}},s=a("KHd+"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lastPage>1?a("nav",{attrs:{"aria-label":"Page navigation"}},[a("ul",{staticClass:"pagination justify-content-center mb-0"},[a("li",{class:["page-item",{disabled:1===e.page}]},[a("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1","aria-disabled":1===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.previous()}}},[e._v("Previous")])]),e._v(" "),e._l(e.lastPage,(function(t){return a("li",{class:["page-item",{active:e.page===t}]},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.change(t)}}},[e._v(e._s(t))])])})),e._v(" "),a("li",{class:["page-item",{disabled:e.lastPage===e.page}]},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-disabled":e.lastPage===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.next()}}},[e._v("Next")])])],2)]):e._e()}),[],!1,null,"d369b0ee",null);t.a=r.exports}}]);