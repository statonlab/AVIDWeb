(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"H/rI":function(e,t,n){"use strict";n.r(t);var s=n("o0o1"),r=n.n(s),a=n("TTxJ"),i=n("m/BY"),o=n("cv7c"),c=n("klO2"),l=n("JUFj"),u=n("wXy6"),d=n("vQtE"),p=n("1MU1"),m=n("mS+z"),v=n("ke3Z"),f=n("yoRh");function h(e,t,n,s,r,a,i){try{var o=e[a](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(s,r)}var _={name:"InvitationForm",components:{InlineSpinner:a.a,Close:f.a,ModalFooter:m.a,ModalBody:p.a,ModalTitle:d.a,ModalHeader:u.a,ModalCard:l.a,Modal:c.a},props:{group:{required:!0,type:Object}},data:function(){return{loading:!1,form:new v.a({name:"",email:""})}},methods:{send:function(){var e,t=this;return(e=r.a.mark((function e(){var n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.form.post("/web/groups/".concat(t.group.id,"/invitations"));case 4:n=e.sent,s=n.data,t.$notify({text:"Invitation sent successfully",type:"success"}),t.$emit("create",s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),e.t0.response&&422===e.t0.response.status||(t.$alert("Unable to send invitation. Please try refreshing the page."),console.error(e.t0));case 13:t.loading=!1;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function i(e){h(a,s,r,i,o,"next",e)}function o(e){h(a,s,r,i,o,"throw",e)}i(void 0)}))})()}}},g=n("KHd+"),b=Object(g.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{on:{close:function(t){return e.$emit("close")}}},[n("form",{attrs:{action:"#",method:"post"},on:{submit:function(t){return t.preventDefault(),e.send(t)},keydown:function(t){return e.form.errors.clear(t.target.name)}}},[n("modal-card",[n("modal-header",[n("modal-title",[e._v("\n                    Invitation\n                ")]),e._v(" "),n("close",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$emit("close")}}})],1),e._v(" "),n("modal-body",[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"name"}},[e._v("Name")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("name")},attrs:{type:"text",id:"name",name:"name",placeholder:"E,g. Jane Doe",required:""},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("name")?n("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("name"))+"\n                    ")]):e._e()]),e._v(" "),n("div",{staticClass:"form-group mb-0"},[n("label",{attrs:{for:"email"}},[e._v("Email")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("email")},attrs:{type:"email",name:"email",id:"email",placeholder:"E,g. jane@example.com",required:""},domProps:{value:e.form.email},on:{input:function(t){t.target.composing||e.$set(e.form,"email",t.target.value)}}}),e._v(" "),e.form.errors.has("email")?n("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("email"))+"\n                    ")]):e._e()])]),e._v(" "),n("modal-footer",{staticClass:"d-flex justify-content-between"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading}},[e.loading?n("inline-spinner"):e._e(),e._v(" "),n("span",[e._v("Send Invitation")])],1),e._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button",disabled:e.loading},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Cancel\n                ")])])],1)],1)])}),[],!1,null,"77a691c2",null).exports,w=n("+Gql"),x=n("t1vV");function y(e,t,n,s,r,a,i){try{var o=e[a](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(s,r)}var C={name:"UserForm",components:{InlineSpinner:a.a,Close:f.a,ModalFooter:m.a,ModalBody:p.a,ModalTitle:d.a,ModalHeader:u.a,ModalCard:l.a,Modal:c.a},props:{user:{required:!0,type:Object},group:{required:!0,type:Object}},data:function(){return{loading:!1,permission:"",form:new v.a({user_id:"",can_view:"",can_edit:""})}},mounted:function(){this.form.setDefault({user_id:this.user.id,can_view:this.user.pivot.can_view,can_edit:this.user.pivot.can_edit}),this.setPermission()},methods:{send:function(){var e,t=this;return(e=r.a.mark((function e(){var n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.form.put("/web/groups/".concat(t.group.id,"/permissions"));case 4:n=e.sent,s=n.data,t.$notify({text:"Member updated successfully.",type:"success"}),t.$emit("update",s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),e.t0.response&&422===e.t0.response.status||(t.$alert("Unable to update member. Please try refreshing the page."),console.error(e.t0));case 13:t.loading=!1;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function i(e){y(a,s,r,i,o,"next",e)}function o(e){y(a,s,r,i,o,"throw",e)}i(void 0)}))})()},setPermission:function(){this.form.can_view&&this.form.can_edit?this.permission="view_edit":this.form.can_view?this.permission="view_only":this.permission="no_permissions"},updatePermissions:function(){switch(this.permission){case"no_permissions":this.form.can_view=0,this.form.can_edit=0;break;case"view_only":this.form.can_view=1,this.form.can_edit=0;break;case"view_edit":this.form.can_view=1,this.form.can_edit=1}}}},k=Object(g.a)(C,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{on:{close:function(t){return e.$emit("close")}}},[n("form",{attrs:{action:"#",method:"post"},on:{submit:function(t){return t.preventDefault(),e.send(t)},keydown:function(t){return e.form.errors.clear(t.target.name)}}},[n("modal-card",[n("modal-header",[n("modal-title",[e._v("\n                    "+e._s("Editing permissions for "+e.user.name)+"\n                ")]),e._v(" "),n("close",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$emit("close")}}})],1),e._v(" "),n("modal-body",[n("div",{staticClass:"custom-control custom-radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"radio-no-permissions",name:"no-permissions"},domProps:{value:"no_permissions",checked:e._q(e.permission,"no_permissions")},on:{change:[function(t){e.permission="no_permissions"},e.updatePermissions]}}),e._v(" "),n("label",{staticClass:"custom-control-label",attrs:{for:"radio-no-permissions"}},[e._v("\n                        "+e._s("User can neither view nor edit")+"\n                    ")])]),e._v(" "),n("div",{staticClass:"custom-control custom-radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"radio-view-only",name:"view-only"},domProps:{value:"view_only",checked:e._q(e.permission,"view_only")},on:{change:[function(t){e.permission="view_only"},e.updatePermissions]}}),e._v(" "),n("label",{staticClass:"custom-control-label",attrs:{for:"radio-view-only"}},[e._v("\n                        "+e._s("User can view only")+"\n                    ")])]),e._v(" "),n("div",{staticClass:"custom-control custom-radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"radio-view-edit",name:"view-edit"},domProps:{value:"view_edit",checked:e._q(e.permission,"view_edit")},on:{change:[function(t){e.permission="view_edit"},e.updatePermissions]}}),e._v(" "),n("label",{staticClass:"custom-control-label",attrs:{for:"radio-view-edit"}},[e._v("\n                        "+e._s("User can view and edit")+"\n                    ")])])]),e._v(" "),n("modal-footer",{staticClass:"d-flex justify-content-between"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading}},[e.loading?n("inline-spinner"):e._e(),e._v(" "),n("span",[e._v("Update Member")])],1),e._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button",disabled:e.loading},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Cancel\n                ")])])],1)],1)])}),[],!1,null,"1f346364",null).exports;function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t,n,s,r,a,i){try{var o=e[a](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(s,r)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function i(e){U(a,s,r,i,o,"next",e)}function o(e){U(a,s,r,i,o,"throw",e)}i(void 0)}))}}var S={name:"Group",components:{SitesDataView:n("Y3if").a,GroupForm:x.a,UserForm:k,InvitationForm:b,Icon:o.a,Avatar:i.a,InlineSpinner:a.a},data:function(){return{User:w.a,group:null,member:null,loading:!0,permissions:null,showInviteForm:!1,showGroupForm:!1,showUserForm:!1,accepted:!1,page:1,lastPage:1,total:0}},mounted:function(){this.loadGroup(),this.loadPermissions(),void 0!==this.$route.query.accepted&&(this.accepted=!0,this.$router.replace({query:{}}))},methods:{loadGroup:function(){var e=this;return F(r.a.mark((function t(){var n,s,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,n=e.$route.params.id,t.prev=2,t.next=5,axios.get("/web/groups/".concat(n));case 5:s=t.sent,a=s.data,e.group=a,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.error(t.t0);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[2,10]])})))()},loadPermissions:function(){var e=this;return F(r.a.mark((function t(){var n,s,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,n=e.$route.params.id,t.prev=2,t.next=5,axios.get("/web/groups/".concat(n,"/permissions"));case 5:s=t.sent,a=s.data,e.permissions=a,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.error(t.t0);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[2,10]])})))()},invitationCreated:function(e){this.showInviteForm=!1,this.group=$($({},this.group),{},{invitations:this.group.invitations.concat([e])})},edit:function(e){this.member=e,this.showUserForm=!0},updated:function(e){this.closeForm(),this.group=$($({},this.group),e)},memberUpdated:function(e){this.closeUserForm(),this.group.users=this.group.users.map((function(t){return t.id===e.id?e:t}))},closeUserForm:function(){this.showUserForm=!1},closeForm:function(){this.showGroupForm=!1},sitesLoaded:function(e){this.page=e.current_page,this.total=e.total,this.lastPage=e.last_page},deleteInvite:function(e){var t,n=this;this.$confirm({title:"Delete ".concat(e.name,"'s Invitation"),text:"This action is permanent.",onConfirm:(t=F(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.delete("/web/invitations/".concat(e.id));case 3:n.group.invitations=n.group.invitations.filter((function(t){return t.id!==e.id})),n.$notify({type:"success",text:"Invitation deleted successfully"}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),n.$notify({text:"Unable to delete invitation. Please try refreshing the page.",type:"error"});case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return t.apply(this,arguments)})})}}},M=Object(g.a)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.loading?n("div",{staticClass:"d-flex align-items-center justify-content-center py-5"},[n("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),!e.loading&&e.group?n("div",[n("div",{staticClass:"d-flex mb-3 align-items-center"},[n("div",{staticClass:"flex-grow-1"},[n("h1",{staticClass:"page-title"},[e._v("\n                    "+e._s(e.group.name)+"\n                ")])]),e._v(" "),n("div",{staticClass:"flex-shrink-0 ml-auto"},[n("div",{staticClass:"text-muted"},[e._v("\n                    Page "+e._s(e.page)+" of "+e._s(e.lastPage)+". "+e._s(e.total)+" sites found.\n                ")])])]),e._v(" "),e.accepted?n("div",{staticClass:"alert alert-success d-flex align-items-center"},[n("div",[e._v("\n                Invitation accepted successfully.\n            ")]),e._v(" "),n("div",{staticClass:"ml-auto pl-2"},[n("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(t){t.preventDefault(),e.accepted=!1}}},[n("icon",{attrs:{name:"close"}})],1)])]):e._e(),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4"},[n("div",{staticClass:"card mb-3"},[n("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[n("strong",[e._v("Members")]),e._v(" "),e.User.owns(e.group)?n("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.showInviteForm=!0}}},[n("icon",{attrs:{name:"add"}}),e._v(" "),n("span",[e._v("Invite")])],1):e._e()]),e._v(" "),n("div",{staticClass:"card-body px-0 pt-0"},e._l(e.group.users,(function(t,s){return n("div",{staticClass:"d-flex align-items-center hover-visible-container hover-highlight px-4 py-2",class:{"mt-3":0!==s}},[n("div",{staticClass:"flex-shrink-0"},[n("avatar",{attrs:{user:t,small:""}})],1),e._v(" "),n("div",{staticClass:"flex-grow-1 px-2"},[n("div",{staticClass:"font-weight-bold"},[e._v(e._s(t.name))]),e._v(" "),e.group.owner.id===t.id?n("div",{staticClass:"text-muted"},[e._v("\n                                    Group Owner\n                                ")]):n("div",{staticClass:"text-muted"},[e._v("\n                                    Group Member\n                                ")])]),e._v(" "),e.User.owns(e.group)?n("div",{staticClass:"flex-shrink-0 hover-visible"},[e.group.owner.id!==t.id?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Edit Member",expression:"'Edit Member'"}],staticClass:"btn btn-link btn-sm mr-0",on:{click:function(n){return n.preventDefault(),e.edit(t)}}},[n("icon",{attrs:{name:"create"}})],1):e._e(),e._v(" "),e.group.owner.id!==t.id?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Remove Member",expression:"`Remove Member`"}],staticClass:"btn btn-link"},[n("icon",{attrs:{name:"trash"}})],1):e._e()]):e._e()])})),0)]),e._v(" "),void 0!==e.group.invitations&&e.group.invitations.length>0?n("div",{staticClass:"card mb-3"},[e._m(0),e._v(" "),n("div",{staticClass:"card-body px-0 pt-0"},e._l(e.group.invitations,(function(t){return n("div",{staticClass:"d-flex align-items-center hover-visible-container hover-highlight px-4 py-2"},[n("div",{staticClass:"flex-grow-1 pr-2"},[n("div",{staticClass:"font-weight-bold"},[e._v(e._s(t.name))]),e._v(" "),t.expired||"pending"!==t.status?t.expired?n("div",{staticClass:"text-danger"},[e._v("\n                                    Expired\n                                ")]):n("div",{staticClass:"text-danger"},[e._v("\n                                    Rejected\n                                ")]):n("div",{staticClass:"text-muted"},[e._v("\n                                    Pending\n                                ")])]),e._v(" "),n("div",{staticClass:"flex-shrink-0 hover-visible"},[n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete Invitation",expression:"`Delete Invitation`"}],staticClass:"btn btn-link",on:{click:function(n){return n.preventDefault(),e.deleteInvite(t)}}},[n("icon",{attrs:{name:"trash"}})],1)])])})),0)]):e._e()]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("sites-data-view",{attrs:{editable:!!e.permissions&&Boolean(e.permissions.can_edit),url:"/web/groups/"+e.group.id+"/sites","site-url-prefix":"/app/groups/"+e.group.id+"/sites","show-owner":!0,"unauthorized-message":"You do not have permission to view sites for this group."},on:{load:function(t){return e.sitesLoaded(t)}}})],1)])]):e._e(),e._v(" "),e.loading||e.group?e._e():n("div",[e._m(1)]),e._v(" "),e.showInviteForm?n("invitation-form",{attrs:{group:e.group},on:{close:function(t){e.showInviteForm=!1},create:function(t){return e.invitationCreated(t)}}}):e._e(),e._v(" "),e.showGroupForm?n("group-form",{attrs:{group:e.group},on:{update:function(t){return e.updated(t)},close:e.closeForm}}):e._e(),e._v(" "),e.showUserForm?n("user-form",{attrs:{group:e.group,user:e.member},on:{update:function(t){return e.memberUpdated(t)},close:e.closeUserForm}}):e._e()],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[t("strong",[this._v("Invitations")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"alert alert-danger"},[this._v("\n            Group not found. Please try refreshing the page or "),t("a",{attrs:{href:"/"}},[this._v("contact us")]),this._v(".\n        ")])}],!1,null,"fe201ed4",null);t.default=M.exports},Y3if:function(e,t,n){"use strict";var s=n("o0o1"),r=n.n(s),a=n("yJCx"),i=n("TTxJ"),o=n("uHij"),c=n("cv7c"),l=n("+Gql"),u=n("wd/R"),d=n.n(u);function p(e,t,n,s,r,a,i){try{var o=e[a](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(s,r)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function i(e){p(a,s,r,i,o,"next",e)}function o(e){p(a,s,r,i,o,"throw",e)}i(void 0)}))}}var v={name:"SitesDataView",components:{Pager:a.a,InlineSpinner:i.a,SiteForm:o.a,Icon:c.a},props:{url:{required:!1,type:String,default:"/web/sites"},editable:{required:!1,type:Boolean,default:!1},showOwner:{required:!1,type:Boolean,default:!1},siteUrlPrefix:{required:!1,type:String,default:"/app/sites"},unauthorizedMessage:{required:!1,type:String,default:"You do not have permission to view sites."}},data:function(){return{moment:d.a,User:l.a,showSiteForm:!1,sites:[],loading:!1,page:1,lastPage:1,total:0,site:null,deleting:null,search:"",_request:null,orderBy:"last_measured_at",orderDir:"desc",unauthorized:!1}},mounted:function(){this.loading=!0,this.loadSites()},watch:{search:function(){this.page=1,this.loadSites()}},methods:{loadSites:function(){var e=this;return m(r.a.mark((function t(){var n,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._request&&e._request(),t.prev=1,t.next=4,axios.get(e.url,{params:{search:e.search,page:e.page,order_by:e.orderBy,order_dir:e.orderDir},cancelToken:new axios.CancelToken((function(t){return e._request=t}))});case 4:n=t.sent,s=n.data,e.total=s.total,e.sites=s.data,e.lastPage=s.last_page,e.loading=!1,e.$emit("load",s),t.next=21;break;case 13:if(t.prev=13,t.t0=t.catch(1),axios.isCancel(t.t0)){t.next=21;break}if(e.loading=!1,!t.t0.response||403!==t.t0.response.status){t.next=20;break}return e.unauthorized=!0,t.abrupt("return");case 20:console.error(t.t0);case 21:case"end":return t.stop()}}),t,null,[[1,13]])})))()},siteCreated:function(){this.loadSites(),this.closeForm()},siteUpdated:function(e){this.sites=this.sites.map((function(t){return t.id===e.id?e:t})),this.closeForm()},closeForm:function(){this.site=null,this.showSiteForm=!1},edit:function(e){this.site=e,this.showSiteForm=!0},destroy:function(e){var t,n=this;this.$confirm({title:"Are you sure you want to delete ".concat(e.name,"?"),text:"This action is permanent!",onConfirm:(t=m(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.deleting=e.id,t.prev=1,t.next=4,axios.delete("/web/sites/".concat(e.id));case 4:return t.next=6,n.loadSites();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),n.$notify({text:"Unable to delete site. Please try refreshing the page.",type:"error"});case 11:n.deleting=null;case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return t.apply(this,arguments)})})},goTo:function(e){this.page=e,this.loadSites()},sort:function(e){e===this.orderBy?this.orderDir="asc"===this.orderDir?"desc":"asc":(this.orderBy=e,this.orderDir="asc"),this.loadSites()},sortIcon:function(e){return e!==this.orderBy?"swap-vertical":"asc"===this.orderDir?"arrow-up":"arrow-down"}}},f=n("KHd+"),h=Object(f.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"card mb-3"},[n("div",{staticClass:"card-header d-flex p-2"},[n("div",{staticClass:"flex-grow-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Search..."},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"ml-auto flex-shrink-0 pl-1"},[n("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.showSiteForm=!0}}},[n("icon",{attrs:{name:"add"}}),e._v(" "),n("span",[e._v("New Site")])],1)])]),e._v(" "),n("div",{staticClass:"card-body p-0 table-responsive"},[e.loading?n("p",{staticClass:"mb-0 p-4"},[n("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),e.unauthorized?n("p",{staticClass:"mb-0 p-4 text-muted"},[e._v("\n                "+e._s(e.unauthorizedMessage)+"\n            ")]):e._e(),e._v(" "),e.loading||0!==e.sites.length||e.unauthorized?e._e():n("p",{staticClass:"mb-0 p-4 text-muted"},[e._v('\n                No results found. Use the "New Site" button above to create a new one.\n            ')]),e._v(" "),!e.loading&&e.sites.length>0&&!e.unauthorized?n("table",{staticClass:"table mb-0 table-middle table-hover table-nowrap"},[n("thead",[n("tr",[n("th",[n("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("name")}}},[n("span",{staticClass:"mr-1"},[e._v("Name")]),e._v(" "),n("icon",{attrs:{name:e.sortIcon("name")}})],1)]),e._v(" "),e.showOwner?n("th",[e._v("\n                        Created By\n                    ")]):e._e(),e._v(" "),n("th",[n("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("plots_count")}}},[n("span",{staticClass:"mr-1"},[e._v("Plots")]),e._v(" "),n("icon",{attrs:{name:e.sortIcon("plots_count")}})],1)]),e._v(" "),n("th",[n("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("plants_count")}}},[n("span",{staticClass:"mr-1"},[e._v("Plants")]),e._v(" "),n("icon",{attrs:{name:e.sortIcon("plants_count")}})],1)]),e._v(" "),n("th",[n("a",{staticClass:"d-flex align-items-center",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.sort("last_measured_at")}}},[n("span",{staticClass:"mr-1"},[e._v("Last Measured")]),e._v(" "),n("icon",{attrs:{name:e.sortIcon("last_measured_at")}})],1)]),e._v(" "),n("th")])]),e._v(" "),n("tbody",e._l(e.sites,(function(t){return n("tr",{class:{"on-hover":e.deleting!==t.id}},[n("td",[n("router-link",{attrs:{to:e.siteUrlPrefix+"/"+t.id}},[n("strong",[e._v(e._s(t.name))])]),e._v(" "),n("div",{staticClass:"text-muted"},[e._v("\n                            "+e._s(t.county.name)+", "+e._s(t.state.code)+"\n                        ")])],1),e._v(" "),e.showOwner?n("td",[e._v(e._s(t.user.name))]):e._e(),e._v(" "),n("td",[e._v(e._s(e._f("plural")(t.plots_count,"Plot","Plots")))]),e._v(" "),n("td",[e._v(e._s(e._f("plural")(t.plants_count,"Plant","Plants")))]),e._v(" "),n("td",[t.last_measured_at?n("span",[e._v("\n                            "+e._s(e.moment(t.last_measured_at).format("MMM Do, YYYY"))+"\n                        ")]):e._e()]),e._v(" "),n("td",{staticClass:"text-right no-wrap"},[n("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"View Plots",expression:"'View Plots'"}],staticClass:"show-on-hover btn btn-link btn-sm",attrs:{to:e.siteUrlPrefix+"/"+t.id}},[n("icon",{attrs:{name:"eye"}})],1),e._v(" "),e.editable||e.User.owns(t)||e.User.can("delete sites")?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Edit Site",expression:"'Edit Site'"}],staticClass:"show-on-hover btn btn-link btn-sm mr-1",on:{click:function(n){return n.preventDefault(),e.edit(t)}}},[n("icon",{attrs:{name:"create"}})],1):e._e(),e._v(" "),e.User.owns(t)||e.User.can("delete sites")?n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete Site",expression:"'Delete Site'"}],staticClass:"show-on-hover btn btn-link btn-sm",on:{click:function(n){return n.preventDefault(),e.destroy(t)}}},[e.deleting!==t.id?n("icon",{attrs:{name:"trash"}}):n("inline-spinner",{staticClass:"text-primary"})],1):e._e()],1)])})),0)]):e._e()])]),e._v(" "),n("pager",{attrs:{"last-page":e.lastPage,page:e.page},on:{change:function(t){return e.goTo(t)}}}),e._v(" "),e.showSiteForm?n("site-form",{attrs:{site:e.site,groupURL:""},on:{close:e.closeForm,create:function(t){return e.siteCreated(t)},update:function(t){return e.siteUpdated(t)}}}):e._e()],1)}),[],!1,null,"05f8d3d1",null);t.a=h.exports},t1vV:function(e,t,n){"use strict";var s=n("o0o1"),r=n.n(s),a=n("klO2"),i=n("JUFj"),o=n("wXy6"),c=n("vQtE"),l=n("yoRh"),u=n("1MU1"),d=n("mS+z"),p=n("ke3Z");function m(e,t,n,s,r,a,i){try{var o=e[a](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(s,r)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function i(e){m(a,s,r,i,o,"next",e)}function o(e){m(a,s,r,i,o,"throw",e)}i(void 0)}))}}var f={name:"GroupForm",components:{ModalFooter:d.a,ModalBody:u.a,Close:l.a,ModalTitle:c.a,ModalHeader:o.a,ModalCard:i.a,Modal:a.a},props:{group:{required:!1}},data:function(){return{form:new p.a({name:""}),loading:!1}},mounted:function(){this.group&&(this.form.name=this.group.name)},methods:{save:function(){this.group?this.update():this.create()},create:function(){var e=this;return v(r.a.mark((function t(){var n,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.form.post("/web/groups");case 3:n=t.sent,s=n.data,e.$notify({type:"success",text:"Group created successfully."}),e.$emit("create",s),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),t.t0.response&&422===t.t0.response.status||e.$alert("Unable to create group. Please try refreshing the page."),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},update:function(){var e=this;return v(r.a.mark((function t(){var n,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.form.put("/web/groups/".concat(e.group.id));case 3:n=t.sent,s=n.data,e.$emit("update",s),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),t.t0.response&&422===t.t0.response.status||e.$alert("Unable to create group. Please try refreshing the page."),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}},h=n("KHd+"),_=Object(h.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{on:{close:function(t){return e.$emit("close")}}},[n("form",{attrs:{action:"#"},on:{submit:function(t){return t.preventDefault(),e.save(t)},keydown:function(t){return e.form.errors.clear(t.target.name)}}},[n("modal-card",[n("modal-header",[e.group?e._e():n("modal-title",[e._v("\n                    Create a Group\n                ")]),e._v(" "),e.group?n("modal-title",[e._v("\n                    Update "+e._s(e.group.name)+"\n                ")]):e._e(),e._v(" "),n("close",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$emit("close")}}})],1),e._v(" "),n("modal-body",[n("div",{staticClass:"form-group mb-0"},[n("label",[e._v("Group Name")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("name")},attrs:{type:"text",name:"name",placeholder:"Group Name",required:""},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("name")?n("div",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("name"))+"\n                    ")]):e._e()])]),e._v(" "),n("modal-footer",{staticClass:"d-flex"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("\n                    Save\n                ")]),e._v(" "),n("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Cancel\n                ")])])],1)],1)])}),[],!1,null,"021db1ba",null);t.a=_.exports},yJCx:function(e,t,n){"use strict";var s={name:"Pager",props:{lastPage:{required:!0,type:Number},page:{required:!0,type:Number}},methods:{previous:function(){1!==this.page&&this.$emit("change",this.page-1)},next:function(){this.lastPage!==this.page&&this.$emit("change",this.page+1)},change:function(e){this.page!==e&&this.$emit("change",e)}}},r=n("KHd+"),a=Object(r.a)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.lastPage>1?n("nav",{attrs:{"aria-label":"Page navigation"}},[n("ul",{staticClass:"pagination justify-content-center mb-0"},[n("li",{class:["page-item",{disabled:1===e.page}]},[n("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1","aria-disabled":1===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.previous()}}},[e._v("Previous")])]),e._v(" "),e._l(e.lastPage,(function(t){return n("li",{class:["page-item",{active:e.page===t}]},[n("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),e.change(t)}}},[e._v(e._s(t))])])})),e._v(" "),n("li",{class:["page-item",{disabled:e.lastPage===e.page}]},[n("a",{staticClass:"page-link",attrs:{href:"#","aria-disabled":e.lastPage===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.next()}}},[e._v("Next")])])],2)]):e._e()}),[],!1,null,"d369b0ee",null);t.a=a.exports}}]);