"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[63],{8336:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var s=n(7757),r=n.n(s);function a(t,e,n,s,r,a,i){try{var o=t[a](i),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(s,r)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(s,r){var i=t.apply(e,n);function o(t){a(i,s,r,o,c,"next",t)}function c(t){a(i,s,r,o,c,"throw",t)}o(void 0)}))}}const o={name:"Roles",components:{InlineSpinner:n(393).Z},data:function(){return{loading:!0,toggling:!1,roles:[],permissions:[],matrix:{}}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;return i(r().mark((function e(){var n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,axios.get("/web/permissions");case 4:n=e.sent,s=n.data,t.roles=s.roles,t.permissions=s.permissions,t.matrix=s.matrix,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.$alert("Unable to load page. Please try refreshing the page.");case 14:t.loading=!1;case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))()},toggle:function(t,e){var n=this;return i(r().mark((function s(){var a,i;return r().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if("Admin"!==e.name){s.next=2;break}return s.abrupt("return");case 2:return n.toggling=!0,s.prev=3,s.next=6,axios.patch("/web/permissions/".concat(t.id,"/roles/").concat(e.id));case 6:a=s.sent,i=a.data,n.matrix[e.id][t.id]=i.attached,n.$notify({type:"success",text:"Role updated successfully"}),s.next=16;break;case 12:s.prev=12,s.t0=s.catch(3),n.$notify({text:"Unable to update role. Please try refreshing the page.",type:"error"}),console.error(s.t0);case 16:n.toggling=!1;case 17:case"end":return s.stop()}}),s,null,[[3,12]])})))()}}};const c=(0,n(1900).Z)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),t._v(" "),t.loading?n("div",{staticClass:"d-flex align-items-center justify-content-center"},[n("inline-spinner",{staticClass:"text-primary"})],1):t._e(),t._v(" "),!t.loading&&t.roles.length>0?n("div",{staticClass:"card"},[n("div",{staticClass:"card-body table-responsive overflow-hidden p-0"},[n("table",{staticClass:"table table-hover table-middle mb-0"},[n("thead",[n("tr",[n("th",{staticClass:"w-100 border-top-0"},[t._v("Permission")]),t._v(" "),t._l(t.roles,(function(e){return n("th",{staticClass:"border-top-0",staticStyle:{width:"0"}},[t._v("\n                        "+t._s(e.name)+"\n                    ")])}))],2)]),t._v(" "),n("tbody",t._l(t.permissions,(function(e){return n("tr",[n("td",[n("p",{staticClass:"mb-0"},[n("strong",[t._v(t._s(e.title))])]),t._v(" "),n("p",{staticClass:"mb-0 text-muted"},[t._v("\n                            "+t._s(e.description)+"\n                        ")])]),t._v(" "),t._l(t.roles,(function(s){return n("td",{staticClass:"text-center"},[n("input",{attrs:{type:"checkbox",disabled:"Admin"===s.name||t.toggling,title:"Admin"===s.name?"Admin role can't be changed":null},domProps:{checked:t.matrix[s.id][e.id]},on:{change:function(n){return n.preventDefault(),t.toggle(e,s)}}})])}))],2)})),0)])])]):t._e()])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mb-3"},[n("h1",{staticClass:"page-title"},[t._v("Roles & Permissions")]),t._v(" "),n("p",{staticClass:"mb-0 text-muted"},[t._v("Manage permissions for each role.")])])}],!1,null,"17a9d2f7",null).exports}}]);
//# sourceMappingURL=roles.9480f649ec41e998.js.map