"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[929],{9119:(e,t,n)=>{function s(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}n.d(t,{Z:()=>a});var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors={},void 0!==t&&this.set(t)}var t,n,a;return t=e,(n=[{key:"get",value:function(e){if(this.errors[e])return"string"==typeof this.errors[e]?this.errors[e]:this.errors[e][0]}},{key:"first",value:function(e){return this.get(e)}},{key:"set",value:function(e){this.errors=e.errors}},{key:"clear",value:function(e){this.errors[e]&&delete this.errors[e]}},{key:"has",value:function(e){return this.errors.hasOwnProperty(e)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"clearAll",value:function(){this.errors={}}},{key:"toArray",value:function(){var e=this,t=[];return Object.keys(this.errors).forEach((function(n){e.errors[n].forEach((function(e){return t.push(e)}))})),t}}])&&s(t.prototype,n),a&&s(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},4207:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(9119);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var l=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors=new s.Z,this.originalData=t,this._multipart=!1,this.fileFields=[],this.onProgressCallback=function(e){},t)t.hasOwnProperty(n)&&(this[n]=t[n])}var t,n,a;return t=e,(n=[{key:"multipart",value:function(e){this._multipart=void 0===e||e}},{key:"keydown",value:function(e){var t=e.target.name;void 0!==t&&void 0!==this[t]&&this.errors.clear(t)}},{key:"onProgressChange",value:function(e){if("function"!=typeof e)throw new s.Z("The function onProgressChange only accepts a function as a parameters");this.onProgressCallback=e}},{key:"data",value:function(e){var t={};for(var n in this.originalData)this.originalData.hasOwnProperty(n)&&(t[n]=this[n]);if(e)for(var s in e)this.originalData.hasOwnProperty(s)&&(t[s]=e[s]);if(this._multipart){var a=new FormData;for(var r in t)t.hasOwnProperty(r)&&(this.isFileField(r)&&FileList&&t[r]instanceof FileList?a.append(r,null===t[r][0]?"":t[r][0]):a.append(r,null===t[r]?"":t[r]));return a}return t}},{key:"isFileField",value:function(e){return this.fileFields.indexOf(e)>-1}},{key:"reset",value:function(){for(var e in this.originalData)this.originalData.hasOwnProperty(e)&&(this[e]=this.originalData[e]);this.errors.clearAll()}},{key:"post",value:function(e,t){return this.submit("post",e,t)}},{key:"put",value:function(e,t){return this.submit("put",e,t)}},{key:"get",value:function(e,t){return this.submit("get",e,t)}},{key:"delete",value:function(e,t){return this.submit("delete",e,t)}},{key:"patch",value:function(e,t){return this.submit("patch",e,t)}},{key:"headers",value:function(){var e={};return this._multipart&&(e["Content-Type"]="multipart/form-data"),e}},{key:"setAsFile",value:function(e){this.isFileField(e)||(this.multipart(!0),this.fileFields.push(e))}},{key:"setAsNotFile",value:function(e){this.fileFields=this.fileFields.filter((function(t){return t!==e})),0===this.fileFields.length&&this.multipart(!1)}},{key:"config",value:function(){return{onUploadProgress:this.onProgressCallback}}},{key:"submit",value:function(e,t,n){var s=this;if(0===t.length)throw new Error("Please provide a valid URL");if(this._multipart&&"post"!==e)throw new Error("Form is set to be multipart but request method is ".concat(e,". Method should be changed to post."));var a=this.headers(),i=this.config();return new Promise((function(o,l){axios[e](t,s.data(n),r(r({},i),{},{headers:a})).then((function(e){o(e)})).catch((function(e){s.onFail(e),l(e)}))}))}},{key:"onFail",value:function(e){e.response&&422===e.response.status&&this.errors.set(e.response.data)}},{key:"setDefault",value:function(e){for(var t in this.originalData){if(!this.originalData.hasOwnProperty(t))return;null!==e[t]?"undefined"!==e[t]&&(this[t]=e[t]):this[t]=null!==this.originalData[t]?this.originalData[t]:null}}}])&&o(t.prototype,n),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},2813:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(4015),a=n.n(s),r=n(3645),i=n.n(r)()(a());i.push([e.id,".close[data-v-7a28cdfc]{margin-top:-25px;right:20px;top:50%}","",{version:3,sources:["webpack://./resources/js/components/Modal/Close.vue"],names:[],mappings:"AAiBA,wBAGA,gBAAA,CAFA,UAAA,CACA,OAEA",sourcesContent:['<template>\n    <button type="button"\n            class="btn btn-close btn-sm ml-auto text-muted position-absolute close"\n            @click="$emit(\'click\', $event)">\n        <icon name="close"/>\n    </button>\n</template>\n\n<script>\n  import Icon from \'../Icon\'\n  export default {\n    name: \'Close\',\n    components: {Icon},\n  }\n<\/script>\n\n<style scoped>\n.close {\n    right: 20px;\n    top: 50%;\n    margin-top: -25px;\n}\n</style>\n'],sourceRoot:""}]);const o=i},724:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(4015),a=n.n(s),r=n(3645),i=n.n(r)()(a());i.push([e.id,".max-vh[data-v-65ec0403]{max-height:93vh}.bg-transparent-dark[data-v-65ec0403]{background-color:rgba(0,0,0,.7)}","",{version:3,sources:["webpack://./resources/js/components/Modal/Modal.vue"],names:[],mappings:"AAiCA,yBACA,eACA,CAEA,sCACA,+BACA",sourcesContent:['<template>\n    <transition name="fade">\n        <div class="modal show vh-100 d-block" tabindex="-1" role="dialog">\n            <button class="modal-backdrop border-0 bg-transparent-dark cursor-default" type="button" @click.prevent="$emit(\'close\')"></button>\n            <div class="modal-dialog"\n                 style="z-index: 1060"\n                 :class="{\'modal-lg\': large, \'modal-md\': medium}"\n                 role="document"\n                 ref="modal">\n                <slot></slot>\n            </div>\n        </div>\n    </transition>\n</template>\n\n<script>\n  export default {\n    name: \'Modal\',\n\n    props: {\n      large : {type: Boolean, required: false, default: false},\n      medium: {type: Boolean, required: false, default: false},\n    },\n\n    data() {\n      return {\n        mounted: false,\n      }\n    },\n  }\n<\/script>\n\n<style scoped>\n    .max-vh {\n        max-height: 93vh;\n    }\n\n    .bg-transparent-dark {\n        background-color: rgba(0, 0, 0, .7);\n    }\n</style>\n'],sourceRoot:""}]);const o=i},7975:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(4015),a=n.n(s),r=n(3645),i=n.n(r)()(a());i.push([e.id,".floating-button[data-v-785c008d]{bottom:10px;position:fixed;right:10px}","",{version:3,sources:["webpack://./resources/js/screens/Species.vue"],names:[],mappings:"AAwRA,kCAEA,WAAA,CADA,cAAA,CAEA,UACA",sourcesContent:['<template>\n  <div>\n    <div class="d-flex mb-3 align-items-center">\n      <h1 class="page-title">Species</h1>\n      <div class="ml-auto text-muted">\n        Page {{ page }} of {{ lastPage }}.\n        Show <select name="limit"\n                     id="limit"\n                     title="per page"\n                     v-model="limit"\n                     class="custom-select d-inline-block w-auto">\n        <option value="20">20</option>\n        <option value="40">40</option>\n        <option value="60">60</option>\n        <option value="80">80</option>\n        <option value="100">100</option>\n      </select> per page.\n      </div>\n    </div>\n    <div class="card mb-3">\n      <div class="card-header d-flex p-2 align-items-center">\n        <div class="flex-grow-1">\n          <input type="search" class="form-control" placeholder="Search..." v-model="search" title="Search">\n        </div>\n        <div class="ml-auto">\n          <button class="btn btn-info" type="button" @click.prevent="merge()" v-if="selected.length > 1">\n            <icon name="git-merge"/>\n            <span>Merge {{ selected.length }} Species</span>\n          </button>\n\n          <button class="btn btn-primary" @click.prevent="showForm = true">\n            <icon name="add"/>\n            <span>Species</span>\n          </button>\n        </div>\n      </div>\n      <div class="card-body p-0">\n        <div class="d-flex align-items-center justify-content-center p-3" v-if="loading">\n          <inline-spinner class="text-primary"/>\n        </div>\n        <p class="text-muted mb-0 p-3" v-if="species.length === 0 && !loading">\n          There are no species found. Please user the "+ species" button above to add one.\n        </p>\n        <div class="table-responsive" v-if="!loading && species.length > 0">\n          <table class="table table-hover table-middle mb-0">\n            <thead>\n            <tr>\n              <th></th>\n              <th>Name</th>\n              <th>Type</th>\n              <th>Plants</th>\n              <th>Overstory</th>\n              <th>Seedling/Shrubs</th>\n              <th></th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr v-for="item in species" class="hover-visible-container">\n              <td style="width: 30px">\n                <input type="checkbox"\n                       title="Select species"\n                       @change="select(item, $event)"\n                       :checked="selected.indexOf(item.id) > -1">\n              </td>\n              <td>\n                <inline-spinner v-if="destroying.indexOf(item.id) > -1" class="text-primary"/>\n                <strong>{{ item.name }}</strong>\n              </td>\n              <td>\n                {{ item.type ? item.type.name : null }}\n              </td>\n              <td>{{ item.plants_count }}</td>\n              <td>{{ item.sites_count }}</td>\n              <td>{{ item.shrubs_count }}</td>\n              <td>\n                <div class="d-flex justify-content-end hover-visible">\n                  <button class="btn btn-link" @click.prevent="edit(item)" v-tooltip="\'Edit\'">\n                    <icon name="create"/>\n                  </button>\n\n                  <button class="btn btn-link"\n                          @click.prevent="destroy(item)"\n                          v-tooltip="\'Delete\'">\n                    <icon name="trash"/>\n                  </button>\n                </div>\n              </td>\n            </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n\n    <pager @change="goTo($event)" :last-page="lastPage" :page="page"/>\n\n    <species-form\n        @close="closeForm"\n        :species="editing"\n        v-if="showForm"\n        @create="created($event)"\n        @update="updated($event)"/>\n\n    <species-merge-form v-if="showMergeForm"\n                        :selected="selected"\n                        @close="showMergeForm = false"\n                        @merged="merged"/>\n\n    <div class="floating-button rounded shadow" v-if="selected.length > 1">\n      <button class="btn btn-info" type="button" @click.prevent="merge()">\n        <icon name="git-merge"/>\n        <span>Merge {{ selected.length }} Species</span>\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Icon from \'../components/Icon\'\nimport InlineSpinner from \'../components/InlineSpinner\'\nimport SpeciesForm from \'../forms/SpeciesForm\'\nimport Pager from \'../components/Pager\'\nimport Errors from \'../forms/Errors\'\nimport SpeciesMergeForm from \'../forms/SpeciesMergeForm\'\n\nexport default {\n  name: \'Species\',\n\n  components: {SpeciesMergeForm, Pager, SpeciesForm, InlineSpinner, Icon},\n\n  data() {\n    return {\n      loading      : true,\n      search       : \'\',\n      species      : [],\n      page         : 1,\n      lastPage     : 1,\n      total        : 0,\n      editing      : null,\n      showForm     : false,\n      request      : null,\n      limit        : \'20\',\n      destroying   : [],\n      selected     : [],\n      showMergeForm: false,\n    }\n  },\n\n  mounted() {\n    this.loadSpecies()\n  },\n\n  watch: {\n    search() {\n      this.loadSpecies()\n    },\n\n    limit() {\n      this.page = 1\n      this.loadSpecies()\n    },\n  },\n\n  methods: {\n    async loadSpecies() {\n      if (this.request) {\n        this.request()\n      }\n\n      try {\n        const {data} = await axios.get(`/web/species`, {\n          params     : {\n            page  : this.page,\n            search: this.search,\n            limit : this.limit,\n          },\n          cancelToken: new axios.CancelToken(c => this.request = c),\n        })\n\n        this.species  = data.data\n        this.page     = data.current_page\n        this.lastPage = data.last_page\n        this.total    = data.total\n      } catch (e) {\n        if (!axios.isCancel(e)) {\n          console.error(e)\n          this.$notify({\n            type: \'error\',\n            text: \'Unable to load species. Please try refreshing the page.\',\n          })\n        }\n      }\n      this.loading = false\n    },\n\n    created(species) {\n      this.loadSpecies()\n      this.editing = null\n    },\n\n    updated(species) {\n      this.editing  = null\n      this.species  = this.species.map(s => s.id === species.id ? species : s)\n      this.showForm = false\n    },\n\n    destroy(species) {\n      this.$confirm({\n        title    : `Delete ${species.name}?`,\n        text     : \'This action is permanent\',\n        onConfirm: async () => {\n          this.destroying.push(species.id)\n          try {\n            await axios.delete(`/web/species/${species.id}`)\n            this.species = this.species.filter(s => s.id !== species.id)\n            this.$notify({\n              type: \'success\',\n              text: \'Species deleted successfully\',\n            })\n          } catch (e) {\n            if (e.response && e.response.status === 422) {\n              const errors = new Errors(e.response.data)\n              if (errors.has(\'species\')) {\n                this.$alert(errors.first(\'species\'))\n              }\n            } else {\n              this.$alert({\n                title: \'Error\',\n                text : \'Unable to delete species. Please try refreshing the page.\',\n              })\n            }\n          }\n\n          this.destroying = this.destroying.filter(id => id !== species.id)\n        },\n      })\n    },\n\n    edit(species) {\n      this.editing  = species\n      this.showForm = true\n    },\n\n    closeForm() {\n      this.editing  = null\n      this.showForm = false\n    },\n\n    goTo(page) {\n      this.loading = true\n      this.page    = page\n      this.loadSpecies()\n    },\n\n    merge() {\n      this.showMergeForm = true\n    },\n\n    select(species, event) {\n      if (this.selected.indexOf(species.id) > -1) {\n        event.target.checked = false\n        this.selected        = this.selected.filter(id => id !== species.id)\n      } else {\n        event.target.checked = true\n        this.selected.push(species.id)\n      }\n    },\n\n    merged() {\n      this.showMergeForm = false\n      this.loading       = true\n      this.page          = 1\n      this.selected      = []\n      this.loadSpecies()\n    },\n  },\n}\n<\/script>\n\n<style scoped>\n.floating-button {\n  position: fixed;\n  bottom: 10px;\n  right: 10px;\n}\n</style>\n'],sourceRoot:""}]);const o=i},304:(e,t,n)=>{n.d(t,{Z:()=>l});const s={name:"Close",components:{Icon:n(4090).Z}};var a=n(3379),r=n.n(a),i=n(2813),o={insert:"head",singleton:!1};r()(i.Z,o);i.Z.locals;const l=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn btn-close btn-sm ml-auto text-muted position-absolute close",attrs:{type:"button"},on:{click:function(t){return e.$emit("click",t)}}},[n("icon",{attrs:{name:"close"}})],1)}),[],!1,null,"7a28cdfc",null).exports},6853:(e,t,n)=>{n.d(t,{Z:()=>l});const s={name:"Modal",props:{large:{type:Boolean,required:!1,default:!1},medium:{type:Boolean,required:!1,default:!1}},data:function(){return{mounted:!1}}};var a=n(3379),r=n.n(a),i=n(724),o={insert:"head",singleton:!1};r()(i.Z,o);i.Z.locals;const l=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[n("div",{staticClass:"modal show vh-100 d-block",attrs:{tabindex:"-1",role:"dialog"}},[n("button",{staticClass:"modal-backdrop border-0 bg-transparent-dark cursor-default",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}}),e._v(" "),n("div",{ref:"modal",staticClass:"modal-dialog",class:{"modal-lg":e.large,"modal-md":e.medium},staticStyle:{"z-index":"1060"},attrs:{role:"document"}},[e._t("default")],2)])])}),[],!1,null,"65ec0403",null).exports},2172:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"ModalBody"};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"modal-body"},[e._t("default")],2)}),[],!1,null,"21f39381",null).exports},1326:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"ModalCard"};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"modal-content shadow-lg border-0"},[e._t("default")],2)}),[],!1,null,"bf90aa66",null).exports},9560:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"ModalFooter"};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"modal-footer justify-content-start border-top-0 bg-light"},[e._t("default")],2)}),[],!1,null,"2efdf4a2",null).exports},420:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"ModalHeader"};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"modal-header position-relative"},[e._t("default")],2)}),[],!1,null,"2075d2dc",null).exports},4217:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"ModalTitle"};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("h3",{staticClass:"modal-title m-0"},[e._t("default")],2)}),[],!1,null,"1e97cd5f",null).exports},8455:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"Pager",props:{lastPage:{required:!0,type:Number},page:{required:!0,type:Number}},methods:{previous:function(){1!==this.page&&this.$emit("change",this.page-1)},next:function(){this.lastPage!==this.page&&this.$emit("change",this.page+1)},change:function(e){this.page!==e&&this.$emit("change",e)}}};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.lastPage>1?n("nav",{attrs:{"aria-label":"Page navigation"}},[n("ul",{staticClass:"pagination justify-content-center mb-0"},[n("li",{class:["page-item",{disabled:1===e.page}]},[n("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1","aria-disabled":1===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.previous()}}},[e._v("Previous")])]),e._v(" "),e._l(e.lastPage,(function(t){return n("li",{class:["page-item",{active:e.page===t}]},[n("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),e.change(t)}}},[e._v(e._s(t))])])})),e._v(" "),n("li",{class:["page-item",{disabled:e.lastPage===e.page}]},[n("a",{staticClass:"page-link",attrs:{href:"#","aria-disabled":e.lastPage===e.page?"true":"false"},on:{click:function(t){return t.preventDefault(),e.next()}}},[e._v("Next")])])],2)]):e._e()}),[],!1,null,"d369b0ee",null).exports},7034:(e,t,n)=>{n.d(t,{Z:()=>a});const s={name:"Required"};const a=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sup",{staticClass:"text-danger"},[e._v("*")])}),[],!1,null,"53582911",null).exports},5831:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var s=n(7757),a=n.n(s),r=n(4090),i=n(393),o=n(1326),l=n(6853),c=n(420),u=n(4217),p=n(304),d=n(2172),m=n(9560),f=n(4207);function h(e,t,n,s,a,r,i){try{var o=e[r](i),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(s,a)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(s,a){var r=e.apply(t,n);function i(e){h(r,s,a,i,o,"next",e)}function o(e){h(r,s,a,i,o,"throw",e)}i(void 0)}))}}const g={name:"SpeciesForm",components:{InlineSpinner:i.Z,ModalFooter:m.Z,ModalBody:d.Z,Close:p.Z,ModalTitle:u.Z,ModalHeader:c.Z,Modal:l.Z,ModalCard:o.Z},props:{species:{required:!1,default:null}},data:function(){return{loading:!1,types:null,loadingTypes:!1,form:new f.Z({name:"",plant_type_id:null})}},mounted:function(){var e=this;return v(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadTypes();case 2:e.species&&e.form.setDefault(e.species);case 3:case"end":return t.stop()}}),t)})))()},methods:{save:function(){this.species?this.update():this.create()},loadTypes:function(){var e=this;return v(a().mark((function t(){var n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingTypes=!0,t.prev=1,t.next=4,axios.get("/web/plant-types");case 4:n=t.sent,s=n.data,e.types=s,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e.$alert("Unable to load form. Please try refreshing the page.");case 12:e.loadingTypes=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},create:function(){var e=this;return v(a().mark((function t(){var n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.form.post("/web/species");case 4:n=t.sent,s=n.data,e.$emit("create",s),e.form.reset(),e.$refs.name.focus(),e.$notify({text:"Species created successfully",type:"success"}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),e.$notify({text:"Unable to create species. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 16:e.loading=!1;case 17:case"end":return t.stop()}}),t,null,[[1,12]])})))()},update:function(){var e=this;return v(a().mark((function t(){var n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.form.put("/web/species/".concat(e.species.id));case 4:n=t.sent,s=n.data,e.$emit("update",s),e.$notify({text:"Species updated successfully",type:"success"}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.$notify({text:"Unable to update species. Please try refreshing the page.",type:"error"}),console.error(t.t0);case 14:e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[1,10]])})))()}}};var y=n(1900);const b=(0,y.Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{on:{close:function(t){return e.$emit("close")}}},[n("form",{attrs:{action:"#"},on:{keydown:function(t){return e.form.errors.clear(t.target.name)},submit:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[n("modal-card",[n("modal-header",[e.species?n("modal-title",[e._v("\n                    Update "+e._s(e.species.name)+"\n                ")]):n("modal-title",[e._v("Create Species")]),e._v(" "),n("close",{on:{click:function(t){return t.preventDefault(),e.$emit("close")}}})],1),e._v(" "),n("modal-body",[e.species?n("div",{staticClass:"alert alert-warning"},[n("p",{staticClass:"mb-0"},[n("strong",[e._v("Warning")])]),e._v(" "),n("div",[e._v("Changing the name of this species will affect any resources that are attached to it such as plants and sites.")])]):e._e(),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"name"}},[e._v("Name")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],ref:"name",staticClass:"form-control",class:{"is-invalid":e.form.errors.has("name")},attrs:{type:"text",autofocus:"",placeholder:"Species Name",name:"name",id:"name"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}}),e._v(" "),e.form.errors.has("name")?n("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("name"))+"\n                    ")]):e._e()]),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"plant"}},[e._v("\n                        Plant Type\n                    ")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.form.plant_type_id,expression:"form.plant_type_id"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("plant_type_id")},attrs:{id:"plant",name:"plant_type_id",disabled:e.loadingTypes},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"plant_type_id",t.target.multiple?n:n[0])}}},[n("option",{domProps:{value:null}},[e._v("None")]),e._v(" "),e._l(e.types,(function(t){return n("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])}))],2),e._v(" "),e.form.errors.has("plant_type_id")?n("small",{staticClass:"form-text text-danger"},[e._v("\n                        "+e._s(e.form.errors.first("plant_type_id"))+"\n                    ")]):e._e()])]),e._v(" "),n("modal-footer",{staticClass:"d-flex"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading}},[e.loading?n("inline-spinner"):e._e(),e._v(" "),n("span",[e._v("Save")])],1),e._v(" "),n("button",{staticClass:"btn btn-light ml-auto",attrs:{type:"button",disabled:e.loading},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n                    Cancel\n                ")])])],1)],1)])}),[],!1,null,"64a10005",null).exports;var _=n(8455),x=n(9119),w=n(7034);function k(e,t,n,s,a,r,i){try{var o=e[r](i),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(s,a)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(s,a){var r=e.apply(t,n);function i(e){k(r,s,a,i,o,"next",e)}function o(e){k(r,s,a,i,o,"throw",e)}i(void 0)}))}}const P={name:"SpeciesMergeForm",props:{selected:{type:Array}},components:{Required:w.Z,Close:p.Z,InlineSpinner:i.Z,ModalFooter:m.Z,ModalBody:d.Z,ModalTitle:u.Z,ModalHeader:c.Z,ModalCard:o.Z,Modal:l.Z},data:function(){return{loading:!0,species:[],plantTypes:[],saving:!1,form:new f.Z({type:"",species:[]})}},mounted:function(){this.loadOptions()},watch:{selected:{immediate:!0,handler:function(){this.form.species=this.selected},deep:!0}},methods:{loadOptions:function(){var e=this;return C(a().mark((function t(){var n,s,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get("/web/species/merge-options",{params:{species:e.selected}});case 3:n=t.sent,s=n.data,e.plantTypes=s.types,e.species=s.species,t.next=14;break;case 9:t.prev=9,t.t0=t.catch(0),t.t0.response&&422===t.t0.response.status?(r=new x.Z(t.t0.response.data),e.$alert(r.toArray().join(" "))):t.t0.response&&403===t.t0.response.status?e.$alert("You are not authorized to complete this action."):e.$alert("Unable to process your request at this time. Please try refreshing the page or contact us."),e.$emit("close"),console.error(t.t0);case 14:e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[0,9]])})))()},merge:function(){var e=this;return C(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.saving){t.next=2;break}return t.abrupt("return");case 2:return e.saving=!0,t.prev=3,t.next=6,e.form.post("/web/species/merge-species");case 6:e.$notify({type:"success",text:"Species merged successfully."}),e.$emit("merged"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(3),t.t0.response&&422===t.t0.response.status?(n=new x.Z(t.t0.response.data),e.$alert(n.toArray().join(" "))):t.t0.response&&403===t.t0.response.status?e.$alert("You are not authorized to complete this action."):e.$alert("Unable to process your request at this time. Please try refreshing the page or contact us."),console.error(t.t0);case 14:e.saving=!1;case 15:case"end":return t.stop()}}),t,null,[[3,10]])})))()}}};function S(e,t,n,s,a,r,i){try{var o=e[r](i),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(s,a)}function $(e){return function(){var t=this,n=arguments;return new Promise((function(s,a){var r=e.apply(t,n);function i(e){S(r,s,a,i,o,"next",e)}function o(e){S(r,s,a,i,o,"throw",e)}i(void 0)}))}}const F={name:"Species",components:{SpeciesMergeForm:(0,y.Z)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{on:{close:function(t){return e.$emit("close")}}},[n("form",{attrs:{action:"#"},on:{submit:function(t){return t.preventDefault(),e.merge.apply(null,arguments)}}},[n("modal-card",[n("modal-header",[n("modal-title",[e._v("Merge Species")]),e._v(" "),n("close",{on:{click:function(t){return e.$emit("close")}}})],1),e._v(" "),n("modal-body",[e.loading?n("div",{staticClass:"d-flex align-items-center justify-content-center"},[n("inline-spinner",{staticClass:"text-primary"})],1):n("div",[n("p",{staticClass:"font-weight-bold"},[e._v("\n            Merging the following species\n          ")]),e._v(" "),n("ul",e._l(e.species,(function(t){return n("li",[n("strong",[e._v(e._s(t.name))]),e._v(" "),t.type?n("div",[n("span",{staticClass:"text-muted"},[e._v(e._s(t.type.name))])]):e._e()])})),0),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"type"}},[e._v("Select Plant Type\n              "),n("required")],1),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.form.type,expression:"form.type"}],staticClass:"custom-select",attrs:{name:"type",id:"type"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"type",t.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[e._v("Select Plant Type")]),e._v(" "),e._l(e.plantTypes,(function(t){return n("option",{domProps:{value:t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])}))],2)])])]),e._v(" "),n("modal-footer",{staticClass:"d-flex justify-content-between"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.saving}},[e.saving?n("inline-spinner"):e._e(),e._v(" "),n("span",[e._v("Merge Species")])],1),e._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("\n          Cancel\n        ")])])],1)],1)])}),[],!1,null,"64846567",null).exports,Pager:_.Z,SpeciesForm:b,InlineSpinner:i.Z,Icon:r.Z},data:function(){return{loading:!0,search:"",species:[],page:1,lastPage:1,total:0,editing:null,showForm:!1,request:null,limit:"20",destroying:[],selected:[],showMergeForm:!1}},mounted:function(){this.loadSpecies()},watch:{search:function(){this.loadSpecies()},limit:function(){this.page=1,this.loadSpecies()}},methods:{loadSpecies:function(){var e=this;return $(a().mark((function t(){var n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.request&&e.request(),t.prev=1,t.next=4,axios.get("/web/species",{params:{page:e.page,search:e.search,limit:e.limit},cancelToken:new axios.CancelToken((function(t){return e.request=t}))});case 4:n=t.sent,s=n.data,e.species=s.data,e.page=s.current_page,e.lastPage=s.last_page,e.total=s.total,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),axios.isCancel(t.t0)||(console.error(t.t0),e.$notify({type:"error",text:"Unable to load species. Please try refreshing the page."}));case 15:e.loading=!1;case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()},created:function(e){this.loadSpecies(),this.editing=null},updated:function(e){this.editing=null,this.species=this.species.map((function(t){return t.id===e.id?e:t})),this.showForm=!1},destroy:function(e){var t,n=this;this.$confirm({title:"Delete ".concat(e.name,"?"),text:"This action is permanent",onConfirm:(t=$(a().mark((function t(){var s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.destroying.push(e.id),t.prev=1,t.next=4,axios.delete("/web/species/".concat(e.id));case 4:n.species=n.species.filter((function(t){return t.id!==e.id})),n.$notify({type:"success",text:"Species deleted successfully"}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),t.t0.response&&422===t.t0.response.status?(s=new x.Z(t.t0.response.data)).has("species")&&n.$alert(s.first("species")):n.$alert({title:"Error",text:"Unable to delete species. Please try refreshing the page."});case 11:n.destroying=n.destroying.filter((function(t){return t!==e.id}));case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return t.apply(this,arguments)})})},edit:function(e){this.editing=e,this.showForm=!0},closeForm:function(){this.editing=null,this.showForm=!1},goTo:function(e){this.loading=!0,this.page=e,this.loadSpecies()},merge:function(){this.showMergeForm=!0},select:function(e,t){this.selected.indexOf(e.id)>-1?(t.target.checked=!1,this.selected=this.selected.filter((function(t){return t!==e.id}))):(t.target.checked=!0,this.selected.push(e.id))},merged:function(){this.showMergeForm=!1,this.loading=!0,this.page=1,this.selected=[],this.loadSpecies()}}};var Z=n(3379),A=n.n(Z),M=n(7975),O={insert:"head",singleton:!1};A()(M.Z,O);M.Z.locals;const D=(0,y.Z)(F,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"d-flex mb-3 align-items-center"},[n("h1",{staticClass:"page-title"},[e._v("Species")]),e._v(" "),n("div",{staticClass:"ml-auto text-muted"},[e._v("\n      Page "+e._s(e.page)+" of "+e._s(e.lastPage)+".\n      Show "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.limit,expression:"limit"}],staticClass:"custom-select d-inline-block w-auto",attrs:{name:"limit",id:"limit",title:"per page"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.limit=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"20"}},[e._v("20")]),e._v(" "),n("option",{attrs:{value:"40"}},[e._v("40")]),e._v(" "),n("option",{attrs:{value:"60"}},[e._v("60")]),e._v(" "),n("option",{attrs:{value:"80"}},[e._v("80")]),e._v(" "),n("option",{attrs:{value:"100"}},[e._v("100")])]),e._v(" per page.\n    ")])]),e._v(" "),n("div",{staticClass:"card mb-3"},[n("div",{staticClass:"card-header d-flex p-2 align-items-center"},[n("div",{staticClass:"flex-grow-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Search...",title:"Search"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"ml-auto"},[e.selected.length>1?n("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.merge()}}},[n("icon",{attrs:{name:"git-merge"}}),e._v(" "),n("span",[e._v("Merge "+e._s(e.selected.length)+" Species")])],1):e._e(),e._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.showForm=!0}}},[n("icon",{attrs:{name:"add"}}),e._v(" "),n("span",[e._v("Species")])],1)])]),e._v(" "),n("div",{staticClass:"card-body p-0"},[e.loading?n("div",{staticClass:"d-flex align-items-center justify-content-center p-3"},[n("inline-spinner",{staticClass:"text-primary"})],1):e._e(),e._v(" "),0!==e.species.length||e.loading?e._e():n("p",{staticClass:"text-muted mb-0 p-3"},[e._v('\n        There are no species found. Please user the "+ species" button above to add one.\n      ')]),e._v(" "),!e.loading&&e.species.length>0?n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-hover table-middle mb-0"},[e._m(0),e._v(" "),n("tbody",e._l(e.species,(function(t){return n("tr",{staticClass:"hover-visible-container"},[n("td",{staticStyle:{width:"30px"}},[n("input",{attrs:{type:"checkbox",title:"Select species"},domProps:{checked:e.selected.indexOf(t.id)>-1},on:{change:function(n){return e.select(t,n)}}})]),e._v(" "),n("td",[e.destroying.indexOf(t.id)>-1?n("inline-spinner",{staticClass:"text-primary"}):e._e(),e._v(" "),n("strong",[e._v(e._s(t.name))])],1),e._v(" "),n("td",[e._v("\n              "+e._s(t.type?t.type.name:null)+"\n            ")]),e._v(" "),n("td",[e._v(e._s(t.plants_count))]),e._v(" "),n("td",[e._v(e._s(t.sites_count))]),e._v(" "),n("td",[e._v(e._s(t.shrubs_count))]),e._v(" "),n("td",[n("div",{staticClass:"d-flex justify-content-end hover-visible"},[n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Edit",expression:"'Edit'"}],staticClass:"btn btn-link",on:{click:function(n){return n.preventDefault(),e.edit(t)}}},[n("icon",{attrs:{name:"create"}})],1),e._v(" "),n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete",expression:"'Delete'"}],staticClass:"btn btn-link",on:{click:function(n){return n.preventDefault(),e.destroy(t)}}},[n("icon",{attrs:{name:"trash"}})],1)])])])})),0)])]):e._e()])]),e._v(" "),n("pager",{attrs:{"last-page":e.lastPage,page:e.page},on:{change:function(t){return e.goTo(t)}}}),e._v(" "),e.showForm?n("species-form",{attrs:{species:e.editing},on:{close:e.closeForm,create:function(t){return e.created(t)},update:function(t){return e.updated(t)}}}):e._e(),e._v(" "),e.showMergeForm?n("species-merge-form",{attrs:{selected:e.selected},on:{close:function(t){e.showMergeForm=!1},merged:e.merged}}):e._e(),e._v(" "),e.selected.length>1?n("div",{staticClass:"floating-button rounded shadow"},[n("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.merge()}}},[n("icon",{attrs:{name:"git-merge"}}),e._v(" "),n("span",[e._v("Merge "+e._s(e.selected.length)+" Species")])],1)]):e._e()],1)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th"),e._v(" "),n("th",[e._v("Name")]),e._v(" "),n("th",[e._v("Type")]),e._v(" "),n("th",[e._v("Plants")]),e._v(" "),n("th",[e._v("Overstory")]),e._v(" "),n("th",[e._v("Seedling/Shrubs")]),e._v(" "),n("th")])])}],!1,null,"785c008d",null).exports}}]);
//# sourceMappingURL=species.cda36451f5335014.js.map